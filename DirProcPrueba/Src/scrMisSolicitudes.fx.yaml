scrMisSolicitudes As screen:
    OnVisible: =Select(icnActualizar)

    Rectangle4 As rectangle:
        BorderColor: =RGBA(255, 191, 0, 1)
        BorderThickness: =1
        Fill: =RGBA(255, 255, 255, 1)
        Height: =664
        Width: =1171
        X: =181
        Y: =93
        ZIndex: =1

    cmpBarraSuperior_5 As cmpBarraSuperior:
        ZIndex: =2

    gaMenuLateral_MS As gallery.galleryVertical:
        Height: =335
        Items: =colBarraLateral
        Layout: =Layout.Vertical
        TemplateSize: =61
        Transition: =Transition.Pop
        Width: =181
        Y: =100
        ZIndex: =3

        Button2_1 As button:
            Align: =Align.Left
            DisplayMode: |-
                =//DisplayMode.Edit
                If(ThisItem.Habilitado,DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =If(ThisItem.texto_boton=varOpcionMenu,RGBA(221, 79, 14, 1),RGBA(221, 79, 14, 70%))
            Height: =61
            HoverFill: =ColorFade(RGBA(221, 79, 14, 1), -20%)
            OnSelect: |-
                =Set(varIdOpcionMenu,ThisItem.id_boton);
                Set(varOpcionMenu,ThisItem.texto_boton);
                Navigate(ThisItem.navegacion,ScreenTransition.Cover)
            PaddingLeft: |
                =ThisItem.sangria*10
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: =ThisItem.texto_boton
            Width: =171
            ZIndex: =1

    lbl_TituloPrincipal_2 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =43
        Size: =24
        Text: ="MIS SOLICITUDES"
        Width: =1072
        X: =278
        Y: =100
        ZIndex: =4

    Label3 As label:
        Height: =33
        Size: =12
        Text: ="Nombre / Nro. Solicitud"
        Width: =196
        X: =186
        Y: =136
        ZIndex: =6

    txtFilNomNroSol As text:
        Default: =
        Width: =812
        X: =186
        Y: =169
        ZIndex: =7

    btnExportar As button:
        OnSelect: |-
            =UpdateContext({
                excelPath: 
                    Exportacion_Excel.Run(
                        JSON(
                            ShowColumns(
                                Search(
                                    Filter(colSolicitudes,
                                        IdSolicitud in(colSolicitudDetalleDestino.IdSolicitud),
                                        ID in(colSolicitudDetalleDestino.IdSolicitudDetalle),
                                        EsAtendido = false,
                                        EsEliminado = false,
                                        EsFinalizado = false,
                                        EsActivo = true // Va a cambiar cuando se anula la solicitud
                                    ),
                                    txtFilNomNroSol.Text,
                                    "NroSolicitud",
                                    "NombreSolicitud"
                                ),
                                "ID", "NroSolicitud", "TipoSolicitud", "TipoServicio", "NombreSolicitud", "EsActivo", "AreaOrigen", 
                                "AreaActual", "AreaDestino", "ManagerDelArea", "LiderDelArea", "AnalistaDelArea", "FechaAtencion", 
                                "FechaExpiraSLA", "FechaExpiraOLA", "ObsSolDet"
                            )
                        )
                    ).excelpath
            });
            
            Notify("Exportacion realizada correctamente.", NotificationType.Success);
            
            //Launch(excelPath);;
        Text: ="Exportar"
        Width: =100
        X: =1129
        Y: =169
        ZIndex: =8

    btnLimpiar As button:
        OnSelect: =Reset(txtFilNomNroSol)
        Text: ="Limpiar"
        Width: =100
        X: =1019
        Y: =169
        ZIndex: =9

    "Gallery1 As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
        Height: =464
        Items: |
            =//colSolicitudes
            //Filter(colSolicitudes;IdSolicitud in(colSolicitudDetalleDestino.IdSolicitud);ID in(colSolicitudDetalleDestino.IdSolicitudDetalle);EsAtendido=false)
            Search(
                Filter(colSolicitudes,
                    IdSolicitud in(colSolicitudDetalleDestino.IdSolicitud),
                    ID in(colSolicitudDetalleDestino.IdSolicitudDetalle),
                    EsAtendido = false,
                    EsEliminado = false,
                    EsFinalizado = false,
                    EsActivo = true // Va a cambiar cuando se anula la solicitud
                ),
                txtFilNomNroSol.Text,
                "NroSolicitud",
                "NombreSolicitud"
            )
        Layout: =Layout.Vertical
        OnSelect: |-
            =Navigate(srcSolicitudDetalle, ScreenTransition.None, { varMisSolicitudesScreen: true });
            //ClearCollect(colSolicitudDetalleItemSel;Gallery1.Selected);;
            //ClearCollect(colSolicitudDetalleItemSelDatosAdj;Gallery1.Selected.'Datos adjuntos');;
            Set(varSolicitudDetalleItemSel,LookUp(colSolicitudes,ID=Gallery1.Selected.ID));
        TemplatePadding: =0
        TemplateSize: =27
        Width: =1166
        X: =190
        Y: =273
        ZIndex: =10

        Title2_4 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.NroSolicitud
            VerticalAlign: =VerticalAlign.Top
            Width: =85
            Y: =4
            ZIndex: =4

        Title2_5 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.NombreSolicitud
            VerticalAlign: =VerticalAlign.Top
            Width: =170
            X: =86
            Y: =4
            ZIndex: =5

        Title2_6 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.TipoSolicitud
            VerticalAlign: =VerticalAlign.Top
            Width: =140
            X: =264
            Y: =4
            ZIndex: =6

        Title2_9 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =Text(ThisItem.FechaAtencion,"dd/mm/yy")
            VerticalAlign: =VerticalAlign.Top
            Width: =70
            X: =1001
            Y: =4
            ZIndex: =8

        Title2_10 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =Text(ThisItem.FechaExpiraSLA,"dd/mm/yy")
            VerticalAlign: =VerticalAlign.Top
            Width: =70
            X: =1077
            Y: =4
            ZIndex: =9

        Title2_11 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AreaOrigen
            VerticalAlign: =VerticalAlign.Top
            Width: =107
            X: =515
            Y: =4
            ZIndex: =10

        Title2_12 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AreaDestino
            VerticalAlign: =VerticalAlign.Top
            Width: =107
            X: =622
            Y: =4
            ZIndex: =11

        Icon5 As icon.ChevronRight:
            Height: =24
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            Width: =15
            X: =1145
            Y: =2
            ZIndex: =12

        Title2_14 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.TipoServicio
            VerticalAlign: =VerticalAlign.Top
            Width: =90
            X: =411
            Y: =4
            ZIndex: =13

        Title2_15 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.ManagerDelArea
            VerticalAlign: =VerticalAlign.Top
            Width: =107
            X: =721
            Y: =4
            ZIndex: =14

    icnActualizar As icon.Reload:
        Height: =39
        Icon: =Icon.Reload
        OnSelect: |+
            =ClearCollect(colSolicitudCab,
                AddColumns(
                    ShowColumns(Solicitud,"ID","NroSolicitud","NombreSolicitud","Obs","EsActivo","EsEliminado","EsFinalizado","IdTipoSolicitud","IdTipoServicio"
                        ,"FechaCreacionSol","FechaFinalSol")
                    ,"TipoSolicitud",LookUp(TipoSolicitud,ID=IdTipoSolicitud,Nombre)
                    ,"TipoServicio",LookUp(TipoServicio,ID=IdTipoServicio,Nombre)
                )
                );
            ClearCollect(colSolicitudes,
                AddColumns(
                    //ShowColumns(SolicitudDetalle;"ID";"FechaAtencion";"FechaExpiraSLA";"FechaExpiraOLA";"EsAtendido";"IdSolicitud";"IdAccionOrigen";"IdEtapaOrigen";"IdAreaOrigen";"IdPerfilOrigen";"IdPersonalOrigen";"IdAccionActual";"IdEtapaActual";"IdAreaActual";"IdPerfilActual";"IdPersonalActual";"IdAccionDestino";"IdEtapaDestino";"IdAreaDestino";"IdPerfilDestino";"IdPersonalDestino")
                    SolicitudDetalle
                    ,"NroSolicitud",LookUp(colSolicitudCab,ID=IdSolicitud,NroSolicitud)
                    ,"NombreSolicitud",LookUp(colSolicitudCab,ID=IdSolicitud,NombreSolicitud)
                    ,"Obs",LookUp(colSolicitudCab,ID=IdSolicitud,Obs)
                    ,"EsActivo",LookUp(colSolicitudCab,ID=IdSolicitud,EsActivo)
                    ,"EsEliminado",LookUp(colSolicitudCab,ID=IdSolicitud,EsEliminado)
                    ,"EsFinalizado",LookUp(colSolicitudCab,ID=IdSolicitud,EsFinalizado)
                    ,"IdTipoSolicitud",LookUp(colSolicitudCab,ID=IdSolicitud,IdTipoSolicitud)
                    ,"TipoSolicitud",LookUp(colSolicitudCab,ID=IdSolicitud,TipoSolicitud)
                    ,"IdTipoServicio",LookUp(colSolicitudCab,ID=IdSolicitud,IdTipoServicio)
                    ,"TipoServicio",LookUp(colSolicitudCab,ID=IdSolicitud,TipoServicio)
                    ,"FechaCreacionSol",LookUp(colSolicitudCab,ID=IdSolicitud,FechaCreacionSol)
                    ,"FechaFinalSol",LookUp(colSolicitudCab,ID=IdSolicitud,FechaFinalSol)
                    ,"AccionOrigen",LookUp(Accion,ID=IdAccionOrigen,Nombre)
                    ,"EtapaOrigen",LookUp(Etapa,ID=IdEtapaOrigen,Nombre)
                    ,"AreaOrigen",LookUp(Area_1,ID=IdAreaOrigen,Nombre)
                    ,"AreaAbrevOrigen",LookUp(Area_1,ID=IdAreaOrigen,NombreAbrev)
                    ,"PerfilOrigen",LookUp(Perfil,ID=IdPerfilOrigen,Nombre)
                    ,"PersonalOrigen",LookUp(Personal,ID=IdPersonalOrigen,Nombre)
                    ,"AccionActual",LookUp(Accion,ID=IdAccionActual,Nombre)
                    ,"EtapaActual",LookUp(Etapa,ID=IdEtapaActual,Nombre)
                    ,"AreaActual",LookUp(Area_1,ID=IdAreaActual,Nombre)
                    ,"AreaAbrevActual",LookUp(Area_1,ID=IdAreaOrigen,NombreAbrev)
                    ,"PerfilActual",LookUp(Perfil,ID=IdPerfilActual,Nombre)
                    ,"PersonalActual",LookUp(Personal,ID=IdPersonalActual,Nombre)
                    ,"AccionDestino",LookUp(Accion,ID=IdAccionDestino,Nombre)
                    ,"EtapaDestino",LookUp(Etapa,ID=IdEtapaDestino,Nombre)
                    ,"AreaDestino",LookUp(Area_1,ID=IdAreaDestino,Nombre)
                    ,"AreaAbrevDestino",LookUp(Area_1,ID=IdAreaDestino,NombreAbrev)
                    ,"PerfilDestino",LookUp(Perfil,ID=IdPerfilDestino,Nombre)
                    ,"PersonalDestino",LookUp(Personal,ID=IdPersonalDestino,Nombre)
                    ,"ManagerDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=2),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    ,"LiderDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=3),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    ,"AnalistaDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=4),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    )
                );
            
            
            //Coleccion para obtener el listado solicitudes y detalle de solicitud pendiente de atender del personal que se logueo
            ClearCollect(colSolicitudDetalleDestino,
                Filter(SolicitudDetalleDestino,IdAreaDestino=varMyUser.IdArea,IdPerfilDestino=varMyUser.IdPerfil,IdPersonalDestino=varMyUser.ID));
            
        Width: =50
        X: =1286
        Y: =170
        ZIndex: =14

    Group2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =27

        Rectangle3 As rectangle:
            Fill: =RGBA(221, 79, 14, 1)
            Height: =50
            Width: =1175
            X: =181
            Y: =219
            ZIndex: =15

        lblHeaderMS_1 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="NRO TICKET"
            Width: =80
            X: =190
            Y: =223
            ZIndex: =16

        lblHeaderMS_2 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="NOMBRE SOL."
            Width: =110
            X: =324
            Y: =223
            ZIndex: =17

        lblHeaderMS_3 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="TIPO SOLIC."
            Width: =80
            X: =477
            Y: =223
            ZIndex: =18

        lblHeaderMS_4 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="TIPO SERV."
            Width: =80
            X: =598
            Y: =223
            ZIndex: =19

        lblHeaderMS_5 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="DPTO. PROCEDENCIA"
            Width: =110
            X: =696
            Y: =223
            ZIndex: =20

        lblHeaderMS_6 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="DPTO. ASIGNADO"
            Width: =100
            X: =809
            Y: =223
            ZIndex: =21

        lblHeaderMS_7 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="MANAGER"
            Width: =93
            X: =904
            Y: =223
            ZIndex: =22

        lblHeaderMS_8 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="LIDER"
            Width: =73
            X: =1013
            Y: =223
            ZIndex: =23

        lblHeaderMS_9 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="ANALISTA"
            Width: =80
            X: =1110
            Y: =223
            ZIndex: =24

        lblHeaderMS_10 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="FECHA CREAC."
            Width: =70
            X: =1191
            Y: =223
            ZIndex: =25

        lblHeaderMS_11 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: |
                =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="FECHA EXPIRA"
            Width: =70
            X: =1260
            Y: =223
            ZIndex: =26

