scrAreaEdit As screen:
    Fill: =
    OnVisible: =

    cmpBarraSuperior_2 As cmpBarraSuperior:

    Rectangle4_5 As rectangle:
        BorderColor: =varColorPri01
        BorderThickness: =1
        Fill: =RGBA(255, 255, 255, 1)
        Height: =699
        Width: =1366
        Y: =69
        ZIndex: =2

    form_EditArea As form:
        DataSource: =Area_1
        DefaultMode: |-
            =FormMode.Edit
            //If(varNewRegArea=1;FormMode.New;FormMode.View)
        Height: =330
        Item: =LookUp(Area_1, ID = varIdArea)//DetAreaGallery.Selected
        OnSuccess: =Set(varIdArea,form_EditArea.LastSubmit.ID)
        Width: =1024
        X: =198
        Y: =80
        ZIndex: =3

        NotificaManager_DataCard1 As typedDataCard.toggleEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="NotificaManager"
            Default: =ThisItem.NotificaManager
            DisplayMode: =Parent.DisplayMode
            DisplayName: |-
                =//DataSourceInfo([@Area_1];DataSourceInfo.DisplayName;"NotificaManager")
                "Noticar a Manager(s)"
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue37.Value
            Width: =250
            X: =0
            Y: =2
            ZIndex: =1

            DataCardKey37 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue37 As toggleSwitch:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DisplayMode: =Parent.DisplayMode
                Font: =Font.'Segoe UI'
                Tooltip: =Parent.DisplayName
                TrueFill: |
                    =//RGBA(56; 96; 178; 1)
                    varColorPri01
                Width: =170
                X: =30
                Y: =DataCardKey37.Y + DataCardKey37.Height + 5
                ZIndex: =2

            ErrorMessage30 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue37.Y + DataCardValue37.Height
                ZIndex: =3

            StarVisible30 As label:
                Align: =Align.Center
                Height: =DataCardKey37.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey37.Y
                ZIndex: =4

        NotificaLider_DataCard1 As typedDataCard.toggleEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="NotificaLider"
            Default: =ThisItem.NotificaLider
            DisplayMode: =Parent.DisplayMode
            DisplayName: |-
                =//DataSourceInfo([@Area_1];DataSourceInfo.DisplayName;"NotificaLider")
                "Notificar a Lideres"
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue38.Value
            Visible: =true
            Width: =250
            WidthFit: =false
            X: =1
            Y: =2
            ZIndex: =1

            DataCardKey38 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue38 As toggleSwitch:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DisplayMode: =Parent.DisplayMode
                Font: =Font.'Segoe UI'
                Tooltip: =Parent.DisplayName
                TrueFill: |-
                    =//RGBA(56; 96; 178; 1)
                    varColorPri01
                Width: =170
                X: =30
                Y: =DataCardKey38.Y + DataCardKey38.Height + 5
                ZIndex: =2

            ErrorMessage31 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue38.Y + DataCardValue38.Height
                ZIndex: =3

            StarVisible31 As label:
                Align: =Align.Center
                Height: =DataCardKey38.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey38.Y
                ZIndex: =4

        CodArea_DataCard1 As typedDataCard.textualEditCard:
            BorderColor: |
                =//RGBA(0; 18; 107; 1)
                varColorPri01B
            BorderStyle: =BorderStyle.Solid
            DataField: ="CodArea"
            Default: =ThisItem.CodArea
            DisplayMode: =Parent.DisplayMode
            DisplayName: |-
                =//DataSourceInfo([@Area_1];DataSourceInfo.DisplayName;"CodArea")
                "Cod. Área"
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@Area_1], DataSourceInfo.MaxLength, "CodArea")
            Required: =false
            Update: =DataCardValue2.Text
            Width: =150
            X: =0
            Y: =0
            ZIndex: =2

            DataCardKey2 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue2 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =Font.'Segoe UI'
                HoverBorderColor: |-
                    =//RGBA(0; 18; 107; 1)
                    varColorPri01B
                HoverColor: |-
                    =RGBA(0, 0, 0, 1)
                    //varColorPri01B
                HoverFill: |-
                    =//RGBA(186; 202; 226; 1)
                    varColorPri01B
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey2.Y + DataCardKey2.Height + 5
                ZIndex: =2

            ErrorMessage2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue2.Y + DataCardValue2.Height
                ZIndex: =3

            StarVisible2 As label:
                Align: =Align.Center
                Height: =DataCardKey2.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey2.Y
                ZIndex: =4

        NombreAbrev_DataCard1 As typedDataCard.textualEditCard:
            BorderColor: |-
                =//RGBA(0; 18; 107; 1)
                varColorPri01B
            BorderStyle: =BorderStyle.Solid
            DataField: ="NombreAbrev"
            Default: =ThisItem.NombreAbrev
            DisplayMode: =Parent.DisplayMode
            DisplayName: |-
                =//DataSourceInfo([@Area_1];DataSourceInfo.DisplayName;"NombreAbrev")
                "Abrev."
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@Area_1], DataSourceInfo.MaxLength, "NombreAbrev")
            Required: =false
            Update: =DataCardValue3.Text
            Width: =200
            X: =1
            Y: =0
            ZIndex: =2

            DataCardKey3 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue3 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =Font.'Segoe UI'
                HoverBorderColor: |-
                    =//RGBA(0; 18; 107; 1)
                    varColorPri01B
                HoverFill: |-
                    =//RGBA(186; 202; 226; 1)
                    varColorPri01B
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey3.Y + DataCardKey3.Height + 5
                ZIndex: =2

            ErrorMessage3 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue3.Y + DataCardValue3.Height
                ZIndex: =3

            StarVisible3 As label:
                Align: =Align.Center
                Height: =DataCardKey3.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey3.Y
                ZIndex: =4

        Title_DataCard1 As typedDataCard.textualEditCard:
            BorderColor: |-
                =//RGBA(0; 18; 107; 1)
                varColorPri01B
            BorderStyle: =BorderStyle.Solid
            DataField: ="Nombre"
            Default: =ThisItem.Nombre
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Area_1],DataSourceInfo.DisplayName,"Nombre")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@Area_1], DataSourceInfo.MaxLength, "Nombre")
            Required: =false
            Update: =DataCardValue1.Text
            Width: =650
            X: =2
            Y: =0
            ZIndex: =2

            DataCardKey1 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =34
                Text: ="Nombre"
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue1 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =Font.'Segoe UI'
                HoverBorderColor: |-
                    =//RGBA(0; 18; 107; 1)
                    varColorPri01B
                HoverFill: |-
                    =//RGBA(186; 202; 226; 1)
                    varColorPri01B
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey1.Y + DataCardKey1.Height + 5
                ZIndex: =2

            ErrorMessage1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue1.Y + DataCardValue1.Height
                ZIndex: =3

            StarVisible1 As label:
                Align: =Align.Center
                Height: =DataCardKey1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey1.Y
                ZIndex: =4

        SLA_DataCard1 As typedDataCard.numberEditCard:
            BorderColor: |-
                =//RGBA(0; 18; 107; 1)
                varColorPri01B
            BorderStyle: =BorderStyle.Solid
            DataField: ="SLA"
            Default: =ThisItem.SLA
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Area_1],DataSourceInfo.DisplayName,"SLA")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =113
            Required: =false
            Update: =Value(DataCardValue4.Text)
            Width: =150
            X: =0
            Y: =1
            ZIndex: =2

            DataCardKey4 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue4 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =Font.'Segoe UI'
                Format: =TextFormat.Number
                HoverBorderColor: |-
                    =//RGBA(0; 18; 107; 1)
                    varColorPri01B
                HoverFill: |-
                    =//RGBA(186; 202; 226; 1)
                    varColorPri01B
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: |
                    =Parent.Width - 60
                X: =30
                Y: =DataCardKey4.Y + DataCardKey4.Height + 5
                ZIndex: =2

            ErrorMessage4 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue4.Y + DataCardValue4.Height
                ZIndex: =3

            StarVisible4 As label:
                Align: =Align.Center
                Height: =DataCardKey4.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey4.Y
                ZIndex: =4

        OLA_DataCard1 As typedDataCard.numberEditCard:
            BorderColor: |-
                =//RGBA(0; 18; 107; 1)
                varColorPri01B
            BorderStyle: =BorderStyle.Solid
            DataField: ="OLA"
            Default: =ThisItem.OLA
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Area_1],DataSourceInfo.DisplayName,"OLA")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =Value(DataCardValue5.Text)
            Width: =150
            X: =1
            Y: =1
            ZIndex: =2

            DataCardKey5 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue5 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =Font.'Segoe UI'
                Format: =TextFormat.Number
                HoverBorderColor: |-
                    =//RGBA(0; 18; 107; 1)
                    varColorPri01B
                HoverFill: |-
                    =//RGBA(186; 202; 226; 1)
                    varColorPri01B
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey5.Y + DataCardKey5.Height + 5
                ZIndex: =2

            ErrorMessage5 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue5.Y + DataCardValue5.Height
                ZIndex: =3

            StarVisible5 As label:
                Align: =Align.Center
                Height: =DataCardKey5.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey5.Y
                ZIndex: =4

        Obs_DataCard1 As typedDataCard.textualEditCard:
            BorderColor: |-
                =//RGBA(0; 18; 107; 1)
                varColorPri01B
            BorderStyle: =BorderStyle.Solid
            DataField: ="Obs"
            Default: =ThisItem.Obs
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Area_1],DataSourceInfo.DisplayName,"Obs")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =127
            MaxLength: =DataSourceInfo([@Area_1], DataSourceInfo.MaxLength, "Obs")
            Required: =false
            Update: =DataCardValue6.Text
            Width: =700
            X: =2
            Y: =1
            ZIndex: =2

            DataCardKey6 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue6 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =Font.'Segoe UI'
                Height: =61
                HoverBorderColor: |-
                    =//RGBA(0; 18; 107; 1)
                    varColorPri01B
                HoverFill: |-
                    =//RGBA(186; 202; 226; 1)
                    varColorPri01B
                MaxLength: =Parent.MaxLength
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey6.Y + DataCardKey6.Height + 5
                ZIndex: =2

            ErrorMessage6 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue6.Y + DataCardValue6.Height
                ZIndex: =3

            StarVisible6 As label:
                Align: =Align.Center
                Height: =DataCardKey6.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey6.Y
                ZIndex: =4

    Icon2 As icon.BackArrow:
        Color: =varColorPri01
        Icon: =Icon.BackArrow
        OnSelect: =ResetForm(form_EditArea);Back()
        X: =13
        Y: =2
        ZIndex: =4

    rectTitManager As rectangle:
        Fill: |-
            =//RGBA(221; 79; 14; 1)
            varColorPri01
        Height: =29
        Width: =355
        X: =108
        Y: =475
        ZIndex: =5

    txtBuscarManager As text:
        Align: =Left
        Default: =""
        DisabledFill: =ColorFade(Color.Black, 0.95)//Self.Fill
        DisplayMode: |
            =// Disable if Form is not equal to editMode
            If(form_EditArea.Mode <> FormMode.Edit,
                DisplayMode.Disabled,
                DisplayMode.Edit
            )
        Font: =Font.'Segoe UI'
        Height: =30
        HintText: ="Buscar"
        PaddingLeft: =35
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =13
        Width: =354
        X: =108
        Y: =504
        ZIndex: =6

    lblTitManager As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =29
        Text: ="MANAGER"
        X: =108
        Y: =475
        ZIndex: =7

    SearchIcon1_1 As icon.Search:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(135, 100, 184, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        DisplayMode: =If(txtBuscarManager.DisplayMode = DisplayMode.Edit, DisplayMode.Edit, DisplayMode.View)
        FocusedBorderThickness: =4
        Height: =30
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Search
        PaddingBottom: =8
        PaddingLeft: =8
        PaddingRight: =8
        PaddingTop: =8
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Tooltip: ="Buscar"
        Width: =38
        X: =108
        Y: =504
        ZIndex: =8

    PeopleAddedGallery1_1 As gallery.SelectedUsersTabletGallery:
        AccessibleLabel: ="Personas seleccionadas por el usuario"
        BorderColor: |-
            =//RGBA(166; 166; 166; 1)
            varColorPri01
        BorderThickness: =1
        Height: =210
        Items: |-
            =Filter(
                AddColumns(AreaManager,
                    "IdArea2",LookUp(Area_1,ID=IdArea).ID,
                    "NombreArea",LookUp(Area_1,ID=IdArea).Nombre,
                    "NombrePersonal",LookUp(Personal,ID=IdPersonal).Nombre,
                    "EmailPersonal",LookUp(Personal,ID=IdPersonal).Email)
                ,IdArea2 = varIdArea)
            //"NombreArea";LookUp(Area_1;ID=AreaManager[@IdArea].Id).Nombre;
            //"NombrePersonal";LookUp(Personal;ID=AreaManager[@IdPersonal].Id).Nombre;
        Layout: =Layout.Vertical
        TemplateFill: |-
            =//RGBA(0; 0; 0; 0)
            //If(ThisItem.IsSelected;ColorFade(RGBA(98;100;167;1);-2%);RGBA(0;0;0;0))
            If(ThisItem.IsSelected, RGBA(89, 89, 89, 1), RGBA(0,0,0,0))
        TemplatePadding: =0
        TemplateSize: =45
        Width: =354
        X: =108
        Y: =txtBuscarManager.Y + txtBuscarManager.Height + 2
        ZIndex: =9

        Rectangle1_1 As rectangle:
            BorderStyle: =BorderStyle.None
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(255, 255, 255, 0)//RGBA(135; 100; 184; 1)
            FocusedBorderThickness: =4
            Height: =Parent.TemplateHeight
            HoverFill: =RGBA(135, 100, 184, 0)
            OnSelect: =Select(Parent)
            PressedFill: =RGBA(89, 89, 89, 0)
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title1_1 As label:
            Color: =If(ThisItem.IsSelected, RGBA(255, 255, 255, 1), RGBA(0, 0, 0, 1))
            Fill: =RGBA(153, 153, 153, 0)
            Font: =Font.'Segoe UI'
            Height: =PeopleAddedGallery1_1.TemplateHeight / 2
            OnSelect: =//Set(_selectedUser; ThisItem)
            PaddingLeft: =10
            Size: =13
            TabIndex: =//If(UserBrowseGallery1.Visible; -1; 0)
            Text: =ThisItem.NombrePersonal
            VerticalAlign: =Middle
            Width: =PeopleAddedGallery1_1.TemplateWidth - iconRemove1_1.Width + 10
            Wrap: =false
            ZIndex: =2

        Label8 As label:
            Color: =If(ThisItem.IsSelected, RGBA(255, 255, 255, 1), RGBA(0, 0, 0, 1))
            Font: =Font.'Segoe UI'
            Height: =Title1_1.Height
            OnSelect: =
            PaddingLeft: =10
            Text: =ThisItem.EmailPersonal
            Width: =Title1_1.Width
            X: =Title1_1.X
            Y: =Title1_1.Y + Title1_1.Height
            ZIndex: =3

        Rectangle1 As rectangle:
            Fill: =RGBA(89, 89, 89, 1)
            FocusedBorderThickness: =0
            Height: =2
            OnSelect: =Select(Parent)
            Width: =Rectangle1_1.Width
            X: =Rectangle1_1.X
            Y: =Rectangle1_1.Y + Rectangle1_1.Height - Self.Height
            ZIndex: =4

        iconRemove1_1 As icon.Cancel:
            AccessibleLabel: =iconRemove1_1.Tooltip
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =Color.White//Title1_1.Color
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: |-
                =//RGBA(228; 3; 44; 1)//RGBA(153; 153; 153; 1)
                varColorPri01
            FocusedBorderThickness: =0
            Height: =PeopleAddedGallery1_1.TemplateHeight
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =Color.White//ColorFade(RGBA(135; 100; 184; 1); -30%)
            HoverFill: =ColorFade(Self.Fill, 0.2)
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({ showConfirmDialog: true, confirmType: 1 });
                Select(Parent)
            PaddingBottom: =9
            PaddingLeft: =9
            PaddingRight: =9
            PaddingTop: =9
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =Color.White//ColorFade(RGBA(135; 100; 184; 1); -30%)
            PressedFill: =ColorFade(Self.Fill, -0.2)
            TabIndex: =//If(UserBrowseGallery1.Visible; -1; 0)
            Tooltip: ="Seleccione esta opción para quitar el usuario de la colección."
            Visible: |-
                =//true
                If(form_EditArea.Mode = FormMode.View,false,true)
            Width: =Self.Height
            X: =PeopleAddedGallery1_1.TemplateWidth - Self.Width
            ZIndex: =5

    UserBrowseGallery1_1 As gallery.PeoplePickerTabletGallery:
        AccessibleLabel: ="Resultados de la búsqueda de usuarios"
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =1
        Fill: =RGBA(255, 255, 255, 1)
        Height: =219
        Items: |
            =//If(!IsBlank(Trim(txtBuscarManager.Text)); UsuariosdeOffice365.SearchUser({searchTerm: Trim(txtBuscarManager.Text); top: 999}))
            If(!IsBlank(Trim(txtBuscarManager.Text)), 
                Filter(UsuariosdeOffice365.SearchUser({searchTerm: Trim(txtBuscarManager.Text), top: 999}),
                Not(UserPrincipalName in AddColumns(AreaManager,"EmailPersonalM",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalM),
                Not(UserPrincipalName in AddColumns(AreaManagerLider,"EmailPersonalML",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalML),
                Not(UserPrincipalName in AddColumns(AreaManagerLiderAnalista,"EmailPersonalMLA",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalMLA)
                )
                )
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TemplatePadding: =0
        TemplateSize: =60
        Visible: =!IsBlank(Trim(txtBuscarManager.Text))
        Width: =354
        X: =108
        Y: =534
        ZIndex: =10

        Rectangle2_1 As rectangle:
            BorderColor: =Title2_1.Color
            BorderThickness: |-
                =//If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName; 2; 0)
                1
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0,0,0,0)
            Height: =58
            HoverFill: =RGBA(0,0,0,0)
            OnSelect: =Select(Title2_1)
            PressedFill: =RGBA(135, 100, 184, 1)
            Width: =Parent.TemplateWidth - 2*Self.X
            X: =1
            Y: =1
            ZIndex: =1

        Title2_1 As label:
            BorderColor: =Self.Color
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =Self.Size * 1.8
            OnSelect: |-
                =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                If(IsBlank(LookUp(Personal, Email = ThisItem.UserPrincipalName)),
                    // New
                    Patch(Personal, 
                        Defaults(Personal), 
                        {
                            Nombre: ThisItem.DisplayName,
                            Email: ThisItem.UserPrincipalName,
                            IdPerfil: 2, 
                            IdArea: varIdArea
                        }
                    ),
                
                    // Edit
                    Patch(Personal, 
                        LookUp(Personal, Email = ThisItem.UserPrincipalName), 
                        {
                            IdPerfil: 2, 
                            IdArea: varIdArea
                        }
                    )
                );
                
                Concurrent(
                //Set(_selectedUser; ThisItem);
                    Reset(txtBuscarManager),
                    Patch(AreaManager,
                        Defaults(AreaManager),
                        {
                            IdArea: varIdArea,
                            IdPersonal: LookUp(Personal, Email = ThisItem.UserPrincipalName).ID
                        }
                    )
                )
                
                
                //If(Not(ThisItem.UserPrincipalName in AddColumns(AreaManager;"EmailPersonal";LookUp(Personal;ID=AreaManager[@IdPersonal].Id).Email).EmailPersonal);
                //Patch(AreaManager;Defaults(AreaManager);{IdArea:{Value:"";Id:varIdArea};IdPersonal:{Value:"";Id:LookUp(Personal; Email = ThisItem.UserPrincipalName).ID}})
                //If(Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName); Collect(MyPeople; ThisItem)))
            TabIndex: =0
            Text: =ThisItem.DisplayName
            VerticalAlign: =Middle
            Width: =UserBrowseGallery1_1.TemplateWidth - 30
            Wrap: =false
            X: =5
            Y: =9
            ZIndex: =4

        Subtitle1_1 As label:
            Color: =RGBA(51, 51, 51, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            Height: =Self.Size * 1.8
            OnSelect: =Select(Title2_1)
            Size: =13
            Text: =ThisItem.UserPrincipalName
            VerticalAlign: =Middle
            Width: =Title2_1.Width
            Wrap: =false
            X: =5
            Y: =31
            ZIndex: =5

        Separator1_1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =58
            ZIndex: =6

    rectTitManager_1 As rectangle:
        Fill: |
            =//RGBA(221; 79; 14; 1)
            varColorPri01
        Height: =29
        Width: =355
        X: =518
        Y: =475
        ZIndex: =11

    txtBuscarLider As text:
        Align: =Left
        Default: =""
        DisabledFill: =ColorFade(Color.Black, 0.95)//Self.Fill
        DisplayMode: |-
            =// Disable if Form is not equal to editMode or Manager is not selected
            If(form_EditArea.Mode <> FormMode.Edit || IsBlank(PeopleAddedGallery1_1.Selected.ID),
                DisplayMode.Disabled,
                DisplayMode.Edit
            )
        Font: =Font.'Segoe UI'
        Height: =30
        HintText: ="Buscar"
        PaddingLeft: =35
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =13
        Width: =354
        X: =518
        Y: =504
        ZIndex: =12

    lblTitManager_1 As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =29
        Text: ="LIDER"
        X: =518
        Y: =475
        ZIndex: =13

    SearchIcon1_2 As icon.Search:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(135, 100, 184, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        DisplayMode: =If(txtBuscarLider.DisplayMode = DisplayMode.Edit, DisplayMode.Edit, DisplayMode.View)
        FocusedBorderThickness: =4
        Height: =30
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Search
        PaddingBottom: =8
        PaddingLeft: =8
        PaddingRight: =8
        PaddingTop: =8
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Tooltip: ="Buscar"
        Width: =38
        X: =518
        Y: =504
        ZIndex: =14

    PeopleAddedGallery1_2 As gallery.SelectedUsersTabletGallery:
        AccessibleLabel: ="Personas seleccionadas por el usuario"
        BorderColor: |-
            =//RGBA(166; 166; 166; 1)
            varColorPri01
        BorderThickness: =1
        Height: =210
        Items: |
            =Filter(
                AddColumns(AreaManagerLider,
                    "IdAreaML",LookUp(Area_1,ID=IdArea).ID,
                    "NombreAreaML",LookUp(Area_1,ID=IdArea).Nombre,
                    "IdAreaManagerML",LookUp(AreaManager,ID=IdAreaManager).ID,
                    "NombrePersonalML",LookUp(Personal,ID=IdPersonal).Nombre,
                    "EmailPersonalML",LookUp(Personal,ID=IdPersonal).Email)
                ,IdAreaML=varIdArea,IdAreaManagerML= PeopleAddedGallery1_1.Selected.ID)
            
            /*
            "IdAreaML";LookUp(Area_1;ID=AreaManagerLider[@IdArea].Id).ID;
            "NombreAreaML";LookUp(Area_1;ID=AreaManagerLider[@IdArea].Id).Nombre;
            "IdAreaManagerML";LookUp(AreaManager;ID=AreaManagerLider[@IdAreaManager].Id).ID;
            "NombrePersonalML";LookUp(Personal;ID=AreaManagerLider[@IdPersonal].Id).Nombre;
            "EmailPersonalML";LookUp(Personal;ID=AreaManagerLider[@IdPersonal].Id).Email)
            */
        Layout: =Layout.Vertical
        TemplateFill: =If(ThisItem.IsSelected, RGBA(89, 89, 89, 1), RGBA(0,0,0,0))
        TemplatePadding: =0
        TemplateSize: =45
        Width: =354
        X: =518
        Y: =txtBuscarLider.Y + txtBuscarLider.Height + 2
        ZIndex: =15

        Rectangle1_2 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(135, 100, 184, 0)
            FocusedBorderThickness: =4
            Height: =Parent.TemplateHeight
            HoverFill: =RGBA(135, 100, 184, 0)
            OnSelect: =Select(Parent)
            PressedFill: =RGBA(135, 100, 184, 0)
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title1_2 As label:
            Color: =If(ThisItem.IsSelected, RGBA(255, 255, 255, 1), RGBA(0, 0, 0, 1))
            Fill: =RGBA(153, 153, 153, 0)
            Font: =Font.'Segoe UI'
            Height: =PeopleAddedGallery1_2.TemplateHeight / 2
            OnSelect: =//Set(_selectedUser2; ThisItem)
            PaddingLeft: =10
            Size: =13
            TabIndex: =//If(UserBrowseGallery1.Visible; -1; 0)
            Text: =ThisItem.NombrePersonalML
            VerticalAlign: =Middle
            Width: =PeopleAddedGallery1_2.TemplateWidth - iconRemove1_2.Width + 10
            Wrap: =false
            ZIndex: =2

        Label4 As label:
            Color: =If(ThisItem.IsSelected, RGBA(255, 255, 255, 1), RGBA(0, 0, 0, 1))
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Lighter
            Height: =Title1_2.Height
            OnSelect: =Select(Parent)
            PaddingLeft: =10
            Text: =ThisItem.EmailPersonalML
            Width: =Title1_2.Width
            X: =Title1_2.X
            Y: =Title1_2.Y + Title1_2.Height
            ZIndex: =3

        Rectangle1_4 As rectangle:
            Fill: =RGBA(89, 89, 89, 1)
            FocusedBorderThickness: =0
            Height: =2
            OnSelect: =Select(Parent)
            Width: =Rectangle1_2.Width
            X: =Rectangle1_2.X
            Y: =Rectangle1_2.Y + Rectangle1_2.Height - Self.Height
            ZIndex: =4

        iconRemove1_2 As icon.Cancel:
            AccessibleLabel: =iconRemove1_2.Tooltip
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =Color.White
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: |-
                =//RGBA(228; 3; 44; 1)//RGBA(153; 153; 153; 1)
                varColorPri01
            FocusedBorderThickness: =0
            Height: =PeopleAddedGallery1_2.TemplateHeight
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =Color.White//ColorFade(RGBA(135; 100; 184; 1); -30%)
            HoverFill: =ColorFade(Self.Fill, 0.2)
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({ showConfirmDialog: true, confirmType: 2 });
                Select(Parent)
            PaddingBottom: =9
            PaddingLeft: =9
            PaddingRight: =9
            PaddingTop: =9
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =Color.White//ColorFade(RGBA(135; 100; 184; 1); -30%)
            PressedFill: =ColorFade(Self.Fill, -0.2)
            TabIndex: =//If(UserBrowseGallery1.Visible; -1; 0)
            Tooltip: ="Seleccione esta opción para quitar el usuario de la colección."
            Visible: =If(form_EditArea.Mode = FormMode.View,false,true)
            Width: =Self.Height
            X: =PeopleAddedGallery1_2.TemplateWidth - Self.Width
            ZIndex: =5

    UserBrowseGallery1_2 As gallery.PeoplePickerTabletGallery:
        AccessibleLabel: ="Resultados de la búsqueda de usuarios"
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =1
        Fill: =RGBA(255, 255, 255, 1)
        Height: =219
        Items: |-
            =//If(!IsBlank(Trim(txtBuscarLider.Text)); UsuariosdeOffice365.SearchUser({searchTerm: Trim(txtBuscarLider.Text); top: 999}))
            If(!IsBlank(Trim(txtBuscarLider.Text)), 
                Filter(UsuariosdeOffice365.SearchUser({searchTerm: Trim(txtBuscarLider.Text), top: 999}),
                    Not(UserPrincipalName in AddColumns(AreaManager,"EmailPersonalM",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalM),
                    Not(UserPrincipalName in AddColumns(AreaManagerLider,"EmailPersonalML",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalML),
                    Not(UserPrincipalName in AddColumns(AreaManagerLiderAnalista,"EmailPersonalMLA",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalMLA)
                )
            )
            
            
            //Not(UserPrincipalName in AddColumns(AreaManager;"EmailPersonalM";LookUp(Personal;ID=AreaManager[@IdPersonal].Id).Email).EmailPersonalM);
            //Not(UserPrincipalName in AddColumns(AreaManagerLider;"EmailPersonalML";LookUp(Personal;ID=AreaManagerLider[@IdPersonal].Id).Email).EmailPersonalML);
            //Not(UserPrincipalName in AddColumns(AreaManagerLiderAnalista;"EmailPersonalMLA";LookUp(Personal;ID=AreaManagerLiderAnalista[@IdPersonal].Id).Email)
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TemplatePadding: =0
        TemplateSize: =60
        Visible: =!IsBlank(Trim(txtBuscarLider.Text))
        Width: =354
        X: =518
        Y: =534
        ZIndex: =16

        Rectangle2_2 As rectangle:
            BorderColor: =Title2_2.Color
            BorderThickness: =0//If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName; 2; 0)
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0,0,0,0)
            Height: =58
            HoverFill: =RGBA(0,0,0,0)
            OnSelect: =Select(Title2_2)
            PressedFill: =RGBA(135, 100, 184, 1)
            Width: =Parent.TemplateWidth - 2*Self.X
            X: =1
            Y: =1
            ZIndex: =1

        Title2_2 As label:
            BorderColor: =Self.Color
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =Self.Size * 1.8
            OnSelect: |-
                =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                //Concurrent(Set(_selectedUser2; ThisItem);Reset(txtBuscarLider);If(Not(ThisItem.UserPrincipalName in MyPeople2.UserPrincipalName); Collect(MyPeople2; ThisItem)))
                If(IsBlank(LookUp(Personal, Email = ThisItem.UserPrincipalName)),
                    // New
                    Patch(Personal, 
                        Defaults(Personal), 
                        {
                            Nombre: ThisItem.DisplayName,
                            Email: ThisItem.UserPrincipalName,
                            IdPerfil: 3, 
                            IdArea: varIdArea
                        }
                    ),
                
                    // Edit
                    Patch(Personal, 
                        LookUp(Personal, Email = ThisItem.UserPrincipalName), 
                        {
                            IdPerfil: 3, 
                            IdArea: varIdArea
                        }
                    )
                );
                
                Reset(txtBuscarLider);
                
                Patch(AreaManagerLider,
                    Defaults(AreaManagerLider),
                    {
                        IdArea: varIdArea,
                        IdAreaManager: PeopleAddedGallery1_1.Selected.ID,
                        IdPersonal: LookUp(Personal, Email = ThisItem.UserPrincipalName).ID
                    }    
                )
            TabIndex: =0
            Text: =ThisItem.DisplayName
            VerticalAlign: =Middle
            Width: =UserBrowseGallery1_2.TemplateWidth - 30
            Wrap: =false
            X: =5
            Y: =9
            ZIndex: =4

        Subtitle1_2 As label:
            Color: =RGBA(51, 51, 51, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            Height: =Self.Size * 1.8
            OnSelect: =Select(Title2_2)
            Size: =13
            Text: =ThisItem.UserPrincipalName
            VerticalAlign: =Middle
            Width: =Title2_2.Width
            Wrap: =false
            X: =5
            Y: =31
            ZIndex: =5

        Separator1_2 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =58
            ZIndex: =6

    rectTitManager_2 As rectangle:
        Fill: |-
            =//RGBA(221; 79; 14; 1)
            varColorPri01
        Height: =29
        Width: =355
        X: =929
        Y: =475
        ZIndex: =17

    txtBuscarAnalista As text:
        Align: =Left
        Default: =""
        DisabledFill: =ColorFade(Color.Black, 0.95)//Self.Fill
        DisplayMode: |-
            =// Disable if Form is not equal to editMode or Leader is not selected
            If(form_EditArea.Mode <> FormMode.Edit || IsBlank(PeopleAddedGallery1_2.Selected.ID),
                DisplayMode.Disabled,
                DisplayMode.Edit
            )
        Font: =Font.'Segoe UI'
        Height: =30
        HintText: ="Buscar"
        PaddingLeft: =35
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =13
        Width: =354
        X: =929
        Y: =504
        ZIndex: =18

    lblTitManager_2 As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =29
        Text: ="ANALISTA"
        X: =929
        Y: =475
        ZIndex: =19

    SearchIcon1_3 As icon.Search:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(135, 100, 184, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        DisplayMode: =If(txtBuscarAnalista.DisplayMode = DisplayMode.Edit, DisplayMode.Edit, DisplayMode.View)
        FocusedBorderThickness: =4
        Height: =30
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Search
        PaddingBottom: =8
        PaddingLeft: =8
        PaddingRight: =8
        PaddingTop: =8
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Tooltip: ="Buscar"
        Width: =38
        X: =929
        Y: =504
        ZIndex: =20

    PeopleAddedGallery1_3 As gallery.SelectedUsersTabletGallery:
        AccessibleLabel: ="Personas seleccionadas por el usuario"
        BorderColor: |-
            =//RGBA(166; 166; 166; 1)
            varColorPri01
        BorderThickness: =1
        Fill: =RGBA(255, 255, 255, 1)
        Height: =210
        Items: |-
            =Filter(
                AddColumns(AreaManagerLiderAnalista,
                    "IdAreaMLA",LookUp(Area_1,ID=IdArea).ID,
                    "NombreAreaMLA",LookUp(Area_1,ID=IdArea).Nombre,
                    "IdAreaManagerMLA",LookUp(AreaManager,ID=IdAreaManager).ID,
                    "IdAreaManagerLiderMLA",LookUp(AreaManagerLider,ID=IdAreaManagerLider).ID,
                    "NombrePersonalMLA",LookUp(Personal,ID=IdPersonal).Nombre,
                    "EmailPersonalMLA",LookUp(Personal,ID=IdPersonal).Email)
                ,IdAreaMLA=varIdArea,IdAreaManagerMLA= PeopleAddedGallery1_1.Selected.ID,IdAreaManagerLiderMLA= PeopleAddedGallery1_2.Selected.ID)
            
            /*
            "IdAreaMLA";LookUp(Area_1;ID=AreaManagerLiderAnalista[@IdArea].Id).ID;
            "NombreAreaMLA";LookUp(Area_1;ID=AreaManagerLiderAnalista[@IdArea].Id).Nombre;
            "IdAreaManagerMLA";LookUp(AreaManager;ID=AreaManagerLiderAnalista[@IdAreaManager].Id).ID;
            "IdAreaManagerLiderMLA";LookUp(AreaManagerLider;ID=AreaManagerLiderAnalista[@IdAreaManagerLider].Id).ID;
            "NombrePersonalMLA";LookUp(Personal;ID=AreaManagerLiderAnalista[@IdPersonal].Id).Nombre;
            "EmailPersonalMLA";LookUp(Personal;ID=AreaManagerLiderAnalista[@IdPersonal].Id).Email)
            */
        Layout: =Layout.Vertical
        TemplateFill: =If(ThisItem.IsSelected, RGBA(89, 89, 89, 1), RGBA(0,0,0,0))
        TemplatePadding: =0
        TemplateSize: =45
        Width: =354
        X: =929
        Y: =txtBuscarAnalista.Y + txtBuscarAnalista.Height + 2
        ZIndex: =21

        Rectangle1_3 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(135, 100, 184, 0)
            FocusedBorderThickness: =4
            Height: =Parent.TemplateHeight
            HoverFill: =RGBA(135, 100, 184, 0)
            OnSelect: =Select(Parent)
            PressedFill: =RGBA(135, 100, 184, 0)
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title1_3 As label:
            Color: =If(ThisItem.IsSelected, RGBA(255, 255, 255, 1), RGBA(0, 0, 0, 1))
            Fill: =RGBA(153, 153, 153, 0)
            Font: =Font.'Segoe UI'
            Height: =PeopleAddedGallery1_3.TemplateHeight / 2
            OnSelect: =//Set(_selectedUser; ThisItem)
            PaddingLeft: =10
            Size: =13
            TabIndex: =0//If(UserBrowseGallery1.Visible; -1; 0)
            Text: =ThisItem.NombrePersonalMLA
            VerticalAlign: =Middle
            Width: =PeopleAddedGallery1_3.TemplateWidth - iconRemove1_3.Width + 10
            Wrap: =false
            ZIndex: =2

        Label9 As label:
            Color: =If(ThisItem.IsSelected, RGBA(255, 255, 255, 1), RGBA(0, 0, 0, 1))
            Font: =Font.'Segoe UI'
            Height: =Title1_3.Height
            OnSelect: =Select(Parent)
            PaddingLeft: =10
            Text: =ThisItem.EmailPersonalMLA
            Width: =Title1_3.Width
            X: =Title1_3.X
            Y: =Title1_3.Y + Title1_3.Height
            ZIndex: =3

        Rectangle1_5 As rectangle:
            Fill: =RGBA(89, 89, 89, 1)
            FocusedBorderThickness: =0
            Height: =2
            OnSelect: =Select(Parent)
            Width: =Rectangle1_3.Width
            X: =Rectangle1_3.X
            Y: =Rectangle1_3.Y + Rectangle1_3.Height - Self.Height
            ZIndex: =4

        iconRemove1_3 As icon.Cancel:
            AccessibleLabel: =iconRemove1_3.Tooltip
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =Color.White//Title1_3.Color
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: |-
                =//RGBA(228; 3; 44; 1)//RGBA(153; 153; 153; 1)
                varColorPri01
            FocusedBorderThickness: =0
            Height: =PeopleAddedGallery1_3.TemplateHeight
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =Color.White//ColorFade(RGBA(135; 100; 184; 1); -30%)
            HoverFill: =ColorFade(Self.Fill, 0.2)
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({ showConfirmDialog: true, confirmType: 3 });
                Select(Parent)
            PaddingBottom: =9
            PaddingLeft: =9
            PaddingRight: =9
            PaddingTop: =9
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =Color.White//ColorFade(RGBA(135; 100; 184; 1); -30%)
            PressedFill: =ColorFade(Self.Fill, -0.2)
            TabIndex: =0//If(UserBrowseGallery1.Visible; -1; 0)
            Tooltip: ="Seleccione esta opción para quitar el usuario de la colección."
            Visible: =If(form_EditArea.Mode = FormMode.View,false,true)
            Width: =Self.Height
            X: =PeopleAddedGallery1_3.TemplateWidth - Self.Width
            ZIndex: =5

    UserBrowseGallery1_3 As gallery.PeoplePickerTabletGallery:
        AccessibleLabel: ="Resultados de la búsqueda de usuarios"
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =1
        Fill: =RGBA(255, 255, 255, 1)
        Height: =219
        Items: |-
            =//If(!IsBlank(Trim(txtBuscarAnalista.Text)); UsuariosdeOffice365.SearchUser({searchTerm: Trim(txtBuscarAnalista.Text); top: 999}))
            If(!IsBlank(Trim(txtBuscarAnalista.Text)), 
                Filter(UsuariosdeOffice365.SearchUser({searchTerm: Trim(txtBuscarAnalista.Text), top: 999}),
                    Not(UserPrincipalName in AddColumns(AreaManager,"EmailPersonalM",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalM),
                    Not(UserPrincipalName in AddColumns(AreaManagerLider,"EmailPersonalML",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalML),
                    Not(UserPrincipalName in AddColumns(AreaManagerLiderAnalista,"EmailPersonalMLA",LookUp(Personal,ID=IdPersonal).Email).EmailPersonalMLA)
                )
            )
            
            /*
            Not(UserPrincipalName in AddColumns(AreaManager;"EmailPersonalM";LookUp(Personal;ID=AreaManager[@IdPersonal].Id).Email).EmailPersonalM);
            Not(UserPrincipalName in AddColumns(AreaManagerLider;"EmailPersonalML";LookUp(Personal;ID=AreaManagerLider[@IdPersonal].Id).Email).EmailPersonalML);
            Not(UserPrincipalName in AddColumns(AreaManagerLiderAnalista;"EmailPersonalMLA";LookUp(Personal;ID=AreaManagerLiderAnalista[@IdPersonal].Id).Email)
            */
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TemplatePadding: =0
        TemplateSize: =60
        Visible: =!IsBlank(Trim(txtBuscarAnalista.Text))
        Width: =354
        X: =929
        Y: =534
        ZIndex: =22

        Rectangle2_3 As rectangle:
            BorderColor: =Title2_3.Color
            BorderThickness: =1//If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName; 2; 0)
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0,0,0,0)
            Height: =58
            HoverFill: =RGBA(0,0,0,0)
            OnSelect: =Select(Title2_3)
            PressedFill: =RGBA(135, 100, 184, 1)
            Width: =Parent.TemplateWidth - 2*Self.X
            X: =1
            Y: =1
            ZIndex: =1

        Title2_3 As label:
            BorderColor: =Self.Color
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =Self.Size * 1.8
            OnSelect: |-
                =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                //Concurrent(Set(_selectedUser3; ThisItem);Reset(txtBuscarAnalista);If(Not(ThisItem.UserPrincipalName in MyPeople3.UserPrincipalName); Collect(MyPeople3; ThisItem)))
                
                If(IsBlank(LookUp(Personal, Email = ThisItem.UserPrincipalName)),
                    // New
                    Patch(Personal, 
                        Defaults(Personal), 
                        {
                            Nombre: ThisItem.DisplayName,
                            Email: ThisItem.UserPrincipalName,
                            IdPerfil: 4,
                            IdArea: varIdArea
                        }
                    ),
                
                    // Edit
                    Patch(Personal, 
                        LookUp(Personal, Email = ThisItem.UserPrincipalName), 
                        {
                            IdPerfil: 4, 
                            IdArea: varIdArea
                        }
                    )
                );
                
                Reset(txtBuscarAnalista);
                
                Patch(AreaManagerLiderAnalista,
                    Defaults(AreaManagerLiderAnalista),
                    {
                        IdArea: varIdArea,
                        IdAreaManager: PeopleAddedGallery1_1.Selected.ID,
                        IdAreaManagerLider: PeopleAddedGallery1_2.Selected.ID,
                        IdPersonal: LookUp(Personal, Email = ThisItem.UserPrincipalName).ID
                    }
                )
            TabIndex: =0
            Text: =ThisItem.DisplayName
            VerticalAlign: =Middle
            Width: =UserBrowseGallery1_3.TemplateWidth - 30
            Wrap: =false
            X: =5
            Y: =9
            ZIndex: =4

        Subtitle1_3 As label:
            Color: =RGBA(51, 51, 51, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            Height: =Self.Size * 1.8
            OnSelect: =Select(Title2_3)
            Size: =13
            Text: =ThisItem.UserPrincipalName
            VerticalAlign: =Middle
            Width: =Title2_3.Width
            Wrap: =false
            X: =5
            Y: =31
            ZIndex: =5

        Separator1_3 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =58
            ZIndex: =6

    btn_GrabarArea_1 As button:
        Fill: |
            =//RGBA(0; 0; 0; 1)
            varColorPri02
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =48
        HoverFill: =ColorFade(Self.Fill, -20%)
        OnSelect: |+
            =SubmitForm(form_EditArea);
            //ResetForm(form_EditArea);;
            
        Text: ="GRABAR AREA"
        Width: =719
        X: =323
        Y: =410
        ZIndex: =23

    Icon3_1 As icon.Edit:
        Color: |-
            =//RGBA(0; 18; 107; 1)
            varColorPri01
        DisplayMode: =If(DataSourceInfo(Area_1, DataSourceInfo.EditPermission), DisplayMode.Edit, DisplayMode.Disabled)
        Height: =47
        Icon: =Icon.Edit
        OnSelect: =EditForm(form_EditArea)
        Tooltip: ="Modificar Datos del Área"
        Visible: |-
            =//true
            If(form_EditArea.Mode = FormMode.View,true,false)
        Width: =46
        X: =1237
        Y: =80
        ZIndex: =24

    lbl_TituloPrincipal_11 As label:
        Align: =Align.Center
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =46
        Size: =24
        Text: ="MANTENIMIENTO DE AREA"
        Width: =665
        X: =420
        Y: =12
        ZIndex: =31

    confirmDialogGroup As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =33

        confirmDialogRect_1 As rectangle:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(0, 0, 0, 0.5)
            FocusedBorderThickness: =0
            Height: =Parent.Height
            Visible: =showConfirmDialog
            Width: =Parent.Width
            ZIndex: =25

        confirmDialogFrame_1 As button:
            BorderThickness: =0
            DisabledFill: =Color.White
            DisplayMode: =DisplayMode.Disabled
            FocusedBorderThickness: =0
            Height: =200
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Text: =""
            Visible: =showConfirmDialog
            Width: =400
            X: =Parent.Width / 2 - Self.Width / 2
            Y: =Parent.Height / 2 - Self.Height / 2
            ZIndex: =26

        confirmDialogTitle_1 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Text: ="¿Eliminar " & If(confirmType = 1, "Manager", confirmType = 2, "Líder", confirmType = 3, "Analista") & "?"
            Visible: =showConfirmDialog
            Width: =confirmDialogFrame_1.Width
            X: =confirmDialogFrame_1.X
            Y: =confirmDialogFrame_1.Y + 15
            ZIndex: =27

        confirmDialogDescription_1 As label:
            Align: =Align.Center
            PaddingLeft: =20
            PaddingRight: =20
            Size: =12
            Text: |-
                =If(confirmType = 3, "El analista eliminado se podrá asignar de nuevo.",
                "Al eliminar al " & If(confirmType = 1, "Manager", confirmType = 2, "Líder") &
                ", todos los " & If(confirmType = 1, "líderes y ") &
                "analistas elegidos también serán eliminados."
                )
            Visible: =showConfirmDialog
            Width: =confirmDialogFrame_1.Width
            X: =confirmDialogFrame_1.X
            Y: =confirmDialogTitle_1.Y + confirmDialogTitle_1.Height + 15
            ZIndex: =28

        confirmDialogYes_1 As icon.Check:
            Color: =Color.Green
            DisplayMode: =If(isProcessing, DisplayMode.Disabled, DisplayMode.Edit)
            Height: =50
            Icon: =Icon.Check
            OnSelect: |-
                =UpdateContext({ isProcessing: true });
                
                // Manager
                If(confirmType = 1,
                	// Remove all Analysts that are equals to this Manager ID
                	RemoveIf(AreaManagerLiderAnalista, IdAreaManager = PeopleAddedGallery1_1.Selected.ID);
                
                	// Remove all Leaders that are equals to this Manager ID
                	RemoveIf(AreaManagerLider, IdAreaManager = PeopleAddedGallery1_1.Selected.ID);
                
                	// Remove this Manager
                	Remove(AreaManager, LookUp(AreaManager, ID = PeopleAddedGallery1_1.Selected.ID));
                
                	Patch(Personal, 
                		LookUp(Personal, Email = PeopleAddedGallery1_1.Selected.EmailPersonal), 
                		{
                			IdPerfil: 1, 
                			IdArea: 0
                		}
                	),
                
                	
                	// Leader
                	confirmType = 2,
                	// Remove all Analysts that are equals to this Leader ID
                	RemoveIf(AreaManagerLiderAnalista, IdAreaManagerLider = PeopleAddedGallery1_2.Selected.ID);
                
                	// Remove this Leader
                	Remove(AreaManagerLider, LookUp(AreaManagerLider, ID = PeopleAddedGallery1_2.Selected.ID));
                
                	Patch(Personal, 
                		LookUp(Personal, Email = PeopleAddedGallery1_2.Selected.EmailPersonalML), 
                		{
                			IdPerfil: 1,
                			IdArea: 0
                		}
                	),
                	
                	
                	// Analyst
                	confirmType = 3,
                	// Remove this Analyst
                	Remove(AreaManagerLiderAnalista, LookUp(AreaManagerLiderAnalista, ID = PeopleAddedGallery1_3.Selected.ID));
                
                	Patch(Personal, 
                		LookUp(Personal, Email = PeopleAddedGallery1_3.Selected.EmailPersonalMLA), 
                		{
                			IdPerfil: 1,
                			IdArea: 0
                		}
                	)
                );
                
                Notify(If(confirmType = 1, "Manager", confirmType = 2, "Líder", confirmType = 3, "Analista") & " eliminado correctamente.", NotificationType.Success);
                
                UpdateContext({ isProcessing: false, showConfirmDialog: false });
            Visible: =showConfirmDialog
            Width: =50
            X: =confirmDialogFrame_1.X + (confirmDialogFrame_1.Width / 2) - Self.Width - 20
            Y: =confirmDialogFrame_1.Y + confirmDialogFrame_1.Height - Self.Height - 20
            ZIndex: =29

        confirmDialogNo_1 As icon.Check:
            Color: =RGBA(228, 3, 44, 1)
            DisplayMode: =If(isProcessing, DisplayMode.Disabled, DisplayMode.Edit)
            Height: =50
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({ showConfirmDialog: false })
            Visible: =showConfirmDialog
            Width: =50
            X: =confirmDialogFrame_1.X + (confirmDialogFrame_1.Width / 2) + 20
            Y: =confirmDialogFrame_1.Y + confirmDialogFrame_1.Height - Self.Height - 20
            ZIndex: =30

