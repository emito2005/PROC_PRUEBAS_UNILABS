scrDerivar As screen:
    OnHidden: =Reset(TextInput2_2)
    OnVisible: |-
        =ResetForm(RequestAttachmentsForm);
        NewForm(RequestAttachmentsForm);
        UpdateContext({ operation: "Derivar" })

    cmpBarraSuperior_11 As cmpBarraSuperior:

    lbl_TituloPrincipal_8 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =38
        Size: =24
        Text: ="DERIVAR SOLICITUD"
        Width: =1335
        X: =13
        Y: =icn_Volver_NS_5.Y + (icn_Volver_NS_5.Height / 2) - (Self.Height / 2)
        ZIndex: =2

    icn_Volver_NS_5 As icon.BackArrow:
        Icon: =Icon.BackArrow
        OnSelect: =Back();
        X: =60
        Y: =100
        ZIndex: =3

    requestFieldGroup_30 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =20
        ZIndex: =6

        requestFieldLbl_42 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="ID"
            Width: =30
            X: =icn_Volver_NS_1.X
            Y: =180
            ZIndex: =4

        requestFieldTxt_30 As text:
            Default: =requestFieldTxt_1.Text
            DisplayMode: =DisplayMode.Disabled
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =120
            X: =requestFieldLbl_42.X + requestFieldLbl_42.Width
            Y: =requestFieldLbl_42.Y
            ZIndex: =5

    requestFieldGroup_31 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =20
        ZIndex: =10

        requestFieldLbl_43 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="Nro. Ticket"
            Width: =100
            X: =requestFieldTxt_30.X + requestFieldTxt_30.Width + 170
            Y: =requestFieldLbl_42.Y
            ZIndex: =6

        requestFieldTxt_31 As text:
            Default: =requestFieldTxt_2.Text
            DisplayMode: =DisplayMode.Disabled
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =120
            X: =requestFieldLbl_43.X + requestFieldLbl_43.Width
            Y: =requestFieldLbl_43.Y
            ZIndex: =7

    requestFieldGroup_32 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =20
        ZIndex: =14

        requestFieldLbl_44 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="Nombre de Solicitud"
            Width: =180
            X: =requestFieldTxt_31.X + requestFieldTxt_31.Width + 100
            Y: =requestFieldLbl_42.Y
            ZIndex: =8

        requestFieldTxt_32 As text:
            Default: =requestFieldTxt_3.Text
            DisplayMode: =DisplayMode.Disabled
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =300
            X: =requestFieldLbl_44.X + requestFieldLbl_44.Width
            Y: =requestFieldLbl_44.Y
            ZIndex: =9

    requestFieldGroup_33 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =20
        ZIndex: =18

        requestFieldLbl_45 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="Tipo de Solicitud"
            X: =requestFieldLbl_42.X
            Y: =requestFieldLbl_42.Y + requestFieldLbl_42.Height + 20
            ZIndex: =10

        requestFieldTxt_33 As text:
            Default: =requestFieldTxt_4.Text
            DisplayMode: =DisplayMode.Disabled
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =200
            X: =requestFieldLbl_45.X + requestFieldLbl_45.Width
            Y: =requestFieldLbl_45.Y
            ZIndex: =11

    requestFieldGroup_34 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =20
        ZIndex: =22

        requestFieldLbl_46 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="Tipo de Servicio"
            Width: =140
            X: =requestFieldTxt_33.X + requestFieldTxt_33.Width + 100
            Y: =requestFieldLbl_45.Y
            ZIndex: =12

        requestFieldTxt_34 As text:
            Default: =requestFieldTxt_5.Text
            DisplayMode: =DisplayMode.Disabled
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =200
            X: =requestFieldLbl_46.X + requestFieldLbl_46.Width
            Y: =requestFieldLbl_46.Y
            ZIndex: =13

    Button5_2 As button:
        OnSelect: |-
            =UpdateContext({ isLoading: true });
            
            // Crear Solicitud Detalle inicial
            UpdateContext({
            	lastSolicitudDetalle:
            		Patch(SolicitudDetalle,
            			Defaults(SolicitudDetalle),
            			{
            				IdSolicitud: varSolicitudDetalleItemSel.IdSolicitud,
            				FechaCreacion: Today(),
            				FechaExpiraSLA: varSolicitudDetalleItemSel.FechaExpiraSLA,
                            //FechaExpiraOLA: varSolicitudDetalleItemSel.FechaExpiraOLA;
                            // Cuando se deriva, la fecha OLA se debe volver a generar ya que cada Area tiene un OLA distinto
            				FechaExpiraOLA: DateAdd(Today(), varMyUserArea.OLA),
            				EsAtendido: false,
            				IdAccionOrigen: 4, // Derivar
            				IdEtapaOrigen: varSolicitudDetalleItemSel.IdEtapaActual,
            				IdAreaOrigen: varMyUser.IdArea,
            				IdPerfilOrigen: varMyUser.IdPerfil,
            				IdPersonalOrigen: varMyUser.ID,
            				IdAccionActual: 0, // Lo actualizará el siguiente usuario
            				//IdEtapaActual: varMyAreaEtapaFlujo.IdEtapaDestino; (esto esta mal)
                            // Correccion
            				IdEtapaActual: varSolicitudDetalleItemSel.IdEtapaDestinoFlujo,
                            //IdAreaActual: varMyAreaEtapaFlujo.IdAreaDestino; (esto esta mal)
                            // Correccion
                            IdAreaActual: varSolicitudDetalleItemSel.IdAreaDestinoFlujo,
                            // Si fuera derivar, Perfil y persona quedaria en 0 porque es de uno a muchos
            				IdPerfilActual: 0,
            				IdPersonalActual: 0,
                            IdAccionDestino: 0, // Siempre será 0 porque todavía no se toma en cuenta
            				IdEtapaDestino: 0, // Etapa Destino Real
            				IdAreaDestino: 0, // Area Destino Real
            				IdPerfilDestino: 0, // Perfil Destino Real
            				IdPersonalDestino: 0, // Personal Destino 
                            //IdEtapaDestinoFlujo: LookUp(AreaEtapaFlujo; IdArea = varMyAreaEtapaFlujo.IdAreaDestino && IdEtapa = varMyAreaEtapaFlujo.IdEtapaDestino).IdEtapaDestino; (esto esta mal)
                            // Correccion
                            IdEtapaDestinoFlujo: 
                            LookUp(AreaEtapaFlujo, 
                                IdArea = varSolicitudDetalleItemSel.IdAreaDestinoFlujo && 
                                IdEtapa = varSolicitudDetalleItemSel.IdEtapaDestinoFlujo
                            ).IdEtapaDestino,
                            //IdAreaDestinoFlujo: LookUp(AreaEtapaFlujo; IdArea = varMyAreaEtapaFlujo.IdAreaDestino && IdEtapa = varMyAreaEtapaFlujo.IdEtapaDestino).IdAreaDestino; (esto esta mal)
                            // Correccion
                            IdAreaDestinoFlujo: 
                            LookUp(AreaEtapaFlujo, 
                                IdArea = varSolicitudDetalleItemSel.IdAreaDestinoFlujo && 
                                IdEtapa = varSolicitudDetalleItemSel.IdEtapaDestinoFlujo
                            ).IdAreaDestino,
                            ObsSolDet: TrimEnds(TextInput2_2.Text)
            			},
                        // Guarda los datos adjuntos luego de crear el nuevo registro
                        RequestAttachmentsForm.Updates
            		)
            });
            
            // Crear Solicitud Detalle Destino de los usuarios designados por area
            // Obtener los managers de la siguiente area
            Clear(colMyManagers);
            ClearCollect(colMyManagers,
            	//Filter(AreaManager; IdArea = varMyAreaEtapaFlujo.IdAreaDestino)
                Filter(AreaManager, IdArea = varSolicitudDetalleItemSel.IdAreaDestinoFlujo)
            );
            
            // Obtener los líderes de la siguiente area
            Clear(colMyLideres);
            ClearCollect(colMyLideres,
            	//Filter(AreaManagerLider; IdArea = varMyAreaEtapaFlujo.IdAreaDestino)
                Filter(AreaManagerLider, IdArea = varSolicitudDetalleItemSel.IdAreaDestinoFlujo)
            );
            
            // Validar si se notificará a los managers
            //If(LookUp(Area_1; ID = varMyAreaEtapaFlujo.IdAreaDestino).NotificaManager;
            If(LookUp(Area_1, ID = varSolicitudDetalleItemSel.IdAreaDestinoFlujo).NotificaManager,
            	ForAll(colMyManagers,
            		Patch(SolicitudDetalleDestino,
            			Defaults(SolicitudDetalleDestino),
            			{
            				IdSolicitud: lastSolicitudDetalle.IdSolicitud,
            				IdSolicitudDetalle: lastSolicitudDetalle.ID,
            				//IdEtapaDestino: varMyAreaEtapaFlujo.IdEtapaDestino;
                            IdEtapaDestino: varSolicitudDetalleItemSel.IdEtapaDestinoFlujo,
            				//IdAreaDestino: varMyAreaEtapaFlujo.IdAreaDestino;
            				IdAreaDestino: varSolicitudDetalleItemSel.IdAreaDestinoFlujo,
                            IdPerfilDestino: 2, // Manager
            				IdPersonalDestino: IdPersonal
            			}
            		)
            	)
            );
            
            // Validar si se notificará a los líderes
            //If(LookUp(Area_1; ID = varMyAreaEtapaFlujo.IdAreaDestino).NotificaLider;
            If(LookUp(Area_1, ID = varSolicitudDetalleItemSel.IdAreaDestinoFlujo).NotificaLider,
            	ForAll(colMyLideres,
            		Patch(SolicitudDetalleDestino,
            			Defaults(SolicitudDetalleDestino),
            			{
            				IdSolicitud: lastSolicitudDetalle.IdSolicitud,
            				IdSolicitudDetalle: lastSolicitudDetalle.ID,
            				//IdEtapaDestino: varMyAreaEtapaFlujo.IdEtapaDestino;
                            IdEtapaDestino: varSolicitudDetalleItemSel.IdEtapaDestinoFlujo,
            				//IdAreaDestino: varMyAreaEtapaFlujo.IdAreaDestino;
            				IdAreaDestino: varSolicitudDetalleItemSel.IdAreaDestinoFlujo,
            				IdPerfilDestino: 3, // Lider
            				IdPersonalDestino: IdPersonal
            			}
            		)
            	)
            );
            
            // Actualizar Solicitud seleccionada con los datos de la persona que esta realizando la accion
            Patch(SolicitudDetalle, 
                LookUp(SolicitudDetalle, ID = varSolicitudDetalleItemSel.ID),
                {
                    IdAccionActual: 4, // Derivar
                    IdPerfilActual: varMyUser.IdPerfil,
                    IdPersonalActual: varMyUser.ID,
                    //IdAreaDestino: varMyAreaEtapaFlujo.IdAreaDestino;
                    IdAreaDestino: varSolicitudDetalleItemSel.IdAreaDestinoFlujo,
                    //IdEtapaDestino: varMyAreaEtapaFlujo.IdEtapaDestino;
                    IdEtapaDestino: varSolicitudDetalleItemSel.IdEtapaDestinoFlujo,
                    IdPerfilDestino: 0,
                    IdPersonalDestino: 0,
                    EsAtendido: true, // Actualizar estado del registro seleccionado
                    IdSolicitudDetalleGenerada: lastSolicitudDetalle.ID, // Guardar ID de la solicitud detalle generada
                    ObsSolDetDestino: TrimEnds(TextInput2_2.Text),
                    FechaAtencion: Today()
                }
            );
            
            Notify("Solicitud derivada correctamente.", NotificationType.Success);
            
            UpdateContext({ isLoading: false });
            
            Navigate(scrMisSolicitudes, Fade);
        Text: ="DERIVAR"
        Width: =Parent.Width / 2
        X: =Parent.Width / 2 - Self.Width / 2
        Y: =Parent.Height - Self.Height - 15
        ZIndex: =24

    requestFieldGroup_35 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =20
        ZIndex: =26

        requestFieldLbl_47 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="Estado"
            Width: =70
            X: =requestFieldTxt_34.X + requestFieldTxt_34.Width + 130
            Y: =requestFieldLbl_45.Y
            ZIndex: =14

        requestFieldTxt_35 As text:
            Default: =requestFieldTxt_6.Text
            DisplayMode: =DisplayMode.Disabled
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =200
            X: =requestFieldLbl_47.X + requestFieldLbl_47.Width
            Y: =requestFieldLbl_47.Y
            ZIndex: =15

    requestFieldLbl_55 As label:
        Color: =RGBA(0, 18, 107, 1)
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Text: |-
            ="Adjuntar Archivo(s):"
        Width: =180
        X: =requestFieldLbl_48.X
        Y: =requestFieldLbl_54.Y + requestFieldLbl_54.Height + 25
        ZIndex: =30

    RequestAttachmentsForm As form:
        DataSource: =SolicitudDetalle
        Height: =Button5_2.Y - Self.Y - 15
        NumberOfColumns: =1
        Width: =300
        X: =requestFieldLbl_55.X + requestFieldLbl_55.Width
        Y: =requestFieldLbl_55.Y
        ZIndex: =31

        "'Datos adjuntos_DataCard3' As typedDataCard.attachmentsEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="{Attachments}"
            Default: =ThisItem.'Datos adjuntos'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Solicitud],DataSourceInfo.DisplayName,"{Attachments}")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =Parent.Height
            Required: =false
            Update: =DataCardValue44.Attachments
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =41

            DataCardValue44 As attachments:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                DisplayMode: =Parent.DisplayMode
                Height: =Parent.Height
                IsInDataCard: =true
                Items: =Parent.Default
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width
                ZIndex: =2

    requestFieldGroup_36 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =20
        ZIndex: =31

        requestFieldLbl_48 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="F. Creación"
            Width: =110
            X: =requestFieldLbl_45.X
            Y: =requestFieldLbl_45.Y + requestFieldLbl_45.Height + 20
            ZIndex: =16

        requestFieldTxt_36 As text:
            Default: =requestFieldTxt_12.Text
            DisplayMode: =DisplayMode.Disabled
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =180
            X: =requestFieldLbl_48.X + requestFieldLbl_48.Width
            Y: =requestFieldLbl_48.Y
            ZIndex: =17

    TextInput2_2 As text:
        Default: =""
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        X: =665
        Y: =545
        ZIndex: =32

    upperToGroup_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =32

        requestFieldLbl_54 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: |-
                ="Derivar Solicitud al Área:"
            Width: =200
            X: =requestFieldLbl_48.X
            Y: =requestFieldLbl_52.Y + requestFieldLbl_52.Height + 20
            ZIndex: =25

        requestFieldLbl_58 As label:
            Color: =RGBA(0, 18, 107, 1)
            FontWeight: =FontWeight.Semibold
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =LookUp(Area_1, ID = varSolicitudDetalleItemSel.IdAreaDestinoFlujo).Nombre
            Width: =requestFieldLbl_52.X + requestFieldLbl_52.Width - Self.X
            X: =requestFieldLbl_54.X + requestFieldLbl_54.Width + 15
            Y: =requestFieldLbl_52.Y + requestFieldLbl_52.Height + 20
            ZIndex: =26

        txtBuscarManager_3 As text:
            Align: =Left
            Default: =""
            DisabledFill: =ColorFade(Color.Black, 0.95)//Self.Fill
            DisplayMode: |
                =// Disable if Form is not equal to editMode
                If(form_EditArea.Mode <> FormMode.Edit,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            HintText: ="Buscar"
            PaddingLeft: =35
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =13
            Visible: =false
            Width: =354
            X: =requestFieldLbl_54.X + requestFieldLbl_54.Width + 10
            Y: =requestFieldLbl_54.Y + (requestFieldLbl_54.Height / 2) - (Self.Height / 2)
            ZIndex: =27

        SearchIcon1_6 As icon.Search:
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(135, 100, 184, 1)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            DisplayMode: =If(txtBuscarManager_3.DisplayMode = DisplayMode.Edit, DisplayMode.Edit, DisplayMode.View)
            FocusedBorderThickness: =4
            Height: =30
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =8
            PaddingTop: =8
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Tooltip: ="Buscar"
            Visible: =false
            Width: =38
            X: =txtBuscarManager_3.X
            Y: =txtBuscarManager_3.Y + (txtBuscarManager_3.Height / 2) - (Self.Height / 2)
            ZIndex: =28

        UserBrowseGallery1_6 As gallery.PeoplePickerTabletGallery:
            AccessibleLabel: ="Resultados de la búsqueda de usuarios"
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height - Self.Y - 20
            Items: |
                =//If(!IsBlank(Trim(txtBuscarManager.Text)); UsuariosdeOffice365.SearchUser({searchTerm: Trim(txtBuscarManager.Text); top: 999}))
                If(!IsBlank(Trim(txtBuscarManager_3.Text)), 
                    /*Filter(*/UsuariosdeOffice365.SearchUser({searchTerm: Trim(txtBuscarManager_3.Text), top: 999})/*;
                    Not(UserPrincipalName in AddColumns(AreaManager;"EmailPersonalM";LookUp(Personal;ID=IdPersonal).Email).EmailPersonalM);
                    Not(UserPrincipalName in AddColumns(AreaManagerLider;"EmailPersonalML";LookUp(Personal;ID=IdPersonal).Email).EmailPersonalML);
                    Not(UserPrincipalName in AddColumns(AreaManagerLiderAnalista;"EmailPersonalMLA";LookUp(Personal;ID=IdPersonal).Email).EmailPersonalMLA)*/
                    //)
                )
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =60
            Visible: =false//!IsBlank(Trim(txtBuscarManager_3.Text))
            Width: =txtBuscarManager_3.Width
            X: =txtBuscarManager_3.X
            Y: =txtBuscarManager_3.Y + txtBuscarManager_3.Height + 5
            ZIndex: =29

            Rectangle2_6 As rectangle:
                BorderColor: =Title2_13.Color
                BorderThickness: |-
                    =//If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName; 2; 0)
                    1
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =58
                HoverFill: =RGBA(0,0,0,0)
                OnSelect: =Select(Title2_13)
                PressedFill: =RGBA(135, 100, 184, 1)
                Width: =Parent.TemplateWidth - 2*Self.X
                X: =1
                Y: =1
                ZIndex: =1

            Title2_13 As label:
                BorderColor: =Self.Color
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: |-
                    =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                    If(IsBlank(LookUp(Personal, Email = ThisItem.UserPrincipalName)),
                        // New
                        Patch(Personal, 
                            Defaults(Personal), 
                            {
                                Nombre: ThisItem.DisplayName,
                                Email: ThisItem.UserPrincipalName,
                                IdPerfil: 2, 
                                IdArea: varIdArea
                            }
                        ),
                    
                        // Edit
                        Patch(Personal, 
                            LookUp(Personal, Email = ThisItem.UserPrincipalName), 
                            {
                                IdPerfil: 2, 
                                IdArea: varIdArea
                            }
                        )
                    );
                    
                    Concurrent(
                    //Set(_selectedUser; ThisItem);
                        Reset(txtBuscarManager),
                        Patch(AreaManager,
                            Defaults(AreaManager),
                            {
                                IdArea: varIdArea,
                                IdPersonal: LookUp(Personal, Email = ThisItem.UserPrincipalName).ID
                            }
                        )
                    )
                    
                    
                    //If(Not(ThisItem.UserPrincipalName in AddColumns(AreaManager;"EmailPersonal";LookUp(Personal;ID=AreaManager[@IdPersonal].Id).Email).EmailPersonal);
                    //Patch(AreaManager;Defaults(AreaManager);{IdArea:{Value:"";Id:varIdArea};IdPersonal:{Value:"";Id:LookUp(Personal; Email = ThisItem.UserPrincipalName).ID}})
                    //If(Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName); Collect(MyPeople; ThisItem)))
                Size: =12
                TabIndex: =0
                Text: =ThisItem.DisplayName
                VerticalAlign: =Middle
                Width: =UserBrowseGallery1_6.TemplateWidth - 30
                Wrap: =false
                X: =5
                Y: =9
                ZIndex: =4

            Subtitle1_6 As label:
                Color: =RGBA(51, 51, 51, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =Self.Size * 1.8
                OnSelect: =Select(Title2_13)
                Size: =12
                Text: =ThisItem.UserPrincipalName
                VerticalAlign: =Middle
                Width: =Title2_13.Width
                Wrap: =false
                X: =5
                Y: =31
                ZIndex: =5

            Separator1_6 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =58
                ZIndex: =6

    Rectangle2_7 As rectangle:
        Fill: =RGBA(0, 0, 0, 0.4)
        Height: =Parent.Height
        Visible: =isLoading
        Width: =Parent.Width
        ZIndex: =34

    requestFieldGroup_37 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =20
        ZIndex: =36

        requestFieldLbl_49 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="F. Expiración"
            Width: =120
            X: =requestFieldTxt_36.X + requestFieldTxt_36.Width + 50
            Y: =requestFieldLbl_48.Y
            ZIndex: =18

        requestFieldTxt_37 As text:
            Default: =requestFieldTxt_13.Text
            DisplayMode: =DisplayMode.Disabled
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =180
            X: =requestFieldLbl_49.X + requestFieldLbl_49.Width
            Y: =requestFieldLbl_49.Y
            ZIndex: =19

    descriptionGroup_7 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =440
        ZIndex: =37

        requestFieldLbl_51 As label:
            Color: =RGBA(0, 18, 107, 1)
            Height: =20
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: |-
                ="Comentario:"
            Width: =110
            X: =RequestAttachmentsForm.X + RequestAttachmentsForm.Width + 15
            Y: =requestFieldLbl_54.Y + requestFieldLbl_54.Height + 25
            ZIndex: =22

        requestFieldLbl_53 As label:
            Color: =RGBA(0, 18, 107, 1)
            Height: =60
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =""
            Width: =requestFieldTxt_11.X + requestFieldTxt_11.Width - Self.X
            X: =requestFieldLbl_51.X + requestFieldLbl_51.Width
            Y: =requestFieldLbl_51.Y
            ZIndex: =23

    descriptionGroup_6 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =39

        requestFieldLbl_50 As label:
            Color: =RGBA(0, 18, 107, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="Descripción"
            Width: =110
            X: =requestFieldLbl_48.X
            Y: =requestFieldLbl_48.Y + requestFieldLbl_48.Height + 20
            ZIndex: =20

        requestFieldLbl_52 As label:
            Color: =RGBA(0, 18, 107, 1)
            Height: =100
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =requestFieldLbl_15.Text
            Width: =requestFieldTxt_11.X + requestFieldTxt_11.Width - Self.X
            X: =requestFieldLbl_50.X + requestFieldLbl_50.Width
            Y: =requestFieldLbl_50.Y
            ZIndex: =21

