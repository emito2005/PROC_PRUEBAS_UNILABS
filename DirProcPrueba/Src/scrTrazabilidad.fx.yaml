scrTrazabilidad As screen:
    OnVisible: =Select(icnActualizarTraza)

    cmpBarraSuperior_8 As cmpBarraSuperior:

    lbl_TituloPrincipal_5 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =38
        Size: =24
        Text: ="TRAZABILIDAD DE SOLICITUD - " & varSolicitudDetalleItemSel.NroSolicitud
        Width: =1335
        X: =13
        Y: =icn_Volver_NS_2.Y + (icn_Volver_NS_2.Height / 2) - (Self.Height / 2)
        ZIndex: =2

    icn_Volver_NS_2 As icon.BackArrow:
        Icon: =Icon.BackArrow
        OnSelect: =Back();
        X: =60
        Y: =100
        ZIndex: =3

    lblHeader_1 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="ID"
        Width: =40
        X: =24
        Y: =icn_Volver_NS_2.Y + icn_Volver_NS_2.Height + 15
        ZIndex: =4

    lblHeader_2 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="ACCION ORIGEN"
        Width: |
            =80
        X: =65
        Y: =lblHeader_1.Y
        ZIndex: =5

    lblHeader_3 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="AREA ORIGEN"
        Width: =70
        X: =143
        Y: =lblHeader_1.Y
        ZIndex: =6

    lblHeader_4 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="PERFIL ORIGEN"
        Width: =80
        X: =214
        Y: =lblHeader_1.Y
        ZIndex: =7

    lblHeader_5 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="COMENTARIO"
        Width: =250
        X: =475
        Y: =lblHeader_1.Y
        ZIndex: =8

    lblHeader_6 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="ACCION DESTINO"
        Width: =80
        X: =lblHeader_5.X + lblHeader_5.Width
        Y: =lblHeader_1.Y
        ZIndex: =9

    lblHeader_7 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="AREA DESTINO"
        Width: =70
        X: =lblHeader_6.X + lblHeader_6.Width
        Y: =lblHeader_1.Y
        ZIndex: =10

    lblHeader_8 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="PERFIL DESTINO"
        Width: =80
        X: =lblHeader_7.X + lblHeader_7.Width
        Y: =lblHeader_1.Y
        ZIndex: =11

    lblHeader_9 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="PERSONAL DESTINO"
        Width: =180
        X: =lblHeader_8.X + lblHeader_8.Width
        Y: =lblHeader_1.Y
        ZIndex: =12

    lblHeader_10 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="FEC. CREAC."
        Width: =70
        X: =lblHeader_9.X + lblHeader_9.Width
        Y: =lblHeader_1.Y
        ZIndex: =13

    "Gallery1_2 As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
        Height: =464
        Items: |
            =//colSolicitudes
            //Filter(colSolicitudes;IdSolicitud in(colSolicitudDetalleDestino.IdSolicitud);ID in(colSolicitudDetalleDestino.IdSolicitudDetalle);EsAtendido=false)
            /*
            Filter(colSolicitudesDetalleTraza;
                IdSolicitud in(colSolicitudDetalleDestino.IdSolicitud);
                ID in(colSolicitudDetalleDestino.IdSolicitudDetalle);
                EsAtendido = false;
                EsEliminado = false;
                EsFinalizado = false;
                EsActivo = true // Va a cambiar cuando se anula la solicitud
            )
            */
            colDetSolicitudTraza
        Layout: =Layout.Vertical
        OnSelect: |-
            =Navigate(srcSolicitudDetalle, ScreenTransition.None);
            //ClearCollect(colSolicitudDetalleItemSel;Gallery1.Selected);;
            //ClearCollect(colSolicitudDetalleItemSelDatosAdj;Gallery1.Selected.'Datos adjuntos');;
            Set(varSolicitudDetalleItemSel,LookUp(colSolicitudes,ID=Gallery1_2.Selected.ID));
        TemplatePadding: =0
        TemplateSize: =27
        Width: =1310
        X: =24
        Y: =222
        ZIndex: =14

        Title2_24 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.ID
            VerticalAlign: =VerticalAlign.Top
            Width: =40
            X: =7
            Y: =3
            ZIndex: =4

        Title2_25 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AccionOrigen
            VerticalAlign: =VerticalAlign.Top
            Width: =80
            X: =51
            Y: =3
            ZIndex: =5

        Title2_26 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AreaAbrevOrigen
            VerticalAlign: =VerticalAlign.Top
            Width: =50
            X: =131
            Y: =3
            ZIndex: =6

        Title2_31 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =Text(ThisItem.FechaCreacion,"dd/mm/yy")
            VerticalAlign: =VerticalAlign.Top
            Width: =70
            X: =1106
            Y: =3
            ZIndex: =8

        Title2_32 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =Text(ThisItem.FechaAtencion,"dd/mm/yy")
            VerticalAlign: =VerticalAlign.Top
            Width: =70
            X: =1182
            Y: =3
            ZIndex: =9

        Title2_28 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.PersonalActual
            VerticalAlign: =VerticalAlign.Top
            Width: =180
            X: =277
            Y: =3
            ZIndex: =10

        Title2_29 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.ObsSolDetDestino
            VerticalAlign: =VerticalAlign.Top
            Width: =250
            X: =461
            Y: =3
            ZIndex: =11

        Icon5_2 As icon.ChevronRight:
            Height: =24
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            Width: =20
            X: =1290
            ZIndex: =12

        Title2_27 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.PerfilOrigen
            VerticalAlign: =VerticalAlign.Top
            Width: =80
            X: =193
            Y: =3
            ZIndex: =13

        Title2_30 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.PersonalDestino
            VerticalAlign: =VerticalAlign.Top
            Width: =180
            X: =938
            Y: =3
            ZIndex: =14

        Title2_34 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.PerfilDestino
            VerticalAlign: =VerticalAlign.Top
            Width: =80
            X: =851
            Y: =3
            ZIndex: =16

        Title2_35 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AreaAbrevDestino
            VerticalAlign: =VerticalAlign.Top
            Width: =50
            X: =785
            Y: =3
            ZIndex: =17

        Title2_33 As label:
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AccionActual
            VerticalAlign: =VerticalAlign.Top
            Width: =80
            X: =700
            Y: =3
            ZIndex: =18

        Icon5_3 As icon.ChevronRight:
            Height: =24
            Icon: =Icon.PaperClip
            OnSelect: =Select(Parent)
            Visible: =ThisItem.'Tiene datos adjuntos'
            Width: =20
            X: =1261
            ZIndex: =19

    icnActualizarTraza As icon.Reload:
        Height: =39
        Icon: =Icon.Reload
        OnSelect: |
            =
            ClearCollect(colSolicitudCabTraza,
                AddColumns(
                    ShowColumns(Filter(Solicitud,ID=varSolicitudDetalleItemSel.IdSolicitud),"ID","NroSolicitud","NombreSolicitud","Obs","EsActivo","EsEliminado","EsFinalizado","IdTipoSolicitud","IdTipoServicio")
                    ,"TipoSolicitud",LookUp(TipoSolicitud,ID=IdTipoSolicitud,Nombre)
                    ,"TipoServicio",LookUp(TipoServicio,ID=IdTipoServicio,Nombre)
                )
                );
            
            
            ClearCollect(colDetSolicitudTraza,
                AddColumns(
                    //ShowColumns(SolicitudDetalle;"ID";"FechaAtencion";"FechaExpiraSLA";"FechaExpiraOLA";"EsAtendido";"IdSolicitud";"IdAccionOrigen";"IdEtapaOrigen";"IdAreaOrigen";"IdPerfilOrigen";"IdPersonalOrigen";"IdAccionActual";"IdEtapaActual";"IdAreaActual";"IdPerfilActual";"IdPersonalActual";"IdAccionDestino";"IdEtapaDestino";"IdAreaDestino";"IdPerfilDestino";"IdPersonalDestino")
                    Filter(SolicitudDetalle,IdSolicitud=varSolicitudDetalleItemSel.IdSolicitud)
                    ,"NroSolicitud",LookUp(colSolicitudCabTraza,ID=IdSolicitud,NroSolicitud)
                    ,"NombreSolicitud",LookUp(colSolicitudCabTraza,ID=IdSolicitud,NombreSolicitud)
                    ,"Obs",LookUp(colSolicitudCabTraza,ID=IdSolicitud,Obs)
                    ,"EsActivo",LookUp(colSolicitudCabTraza,ID=IdSolicitud,EsActivo)
                    ,"EsEliminado",LookUp(colSolicitudCabTraza,ID=IdSolicitud,EsEliminado)
                    ,"EsFinalizado",LookUp(colSolicitudCabTraza,ID=IdSolicitud,EsFinalizado)
                    ,"IdTipoSolicitud",LookUp(colSolicitudCabTraza,ID=IdSolicitud,IdTipoSolicitud)
                    ,"TipoSolicitud",LookUp(colSolicitudCabTraza,ID=IdSolicitud,TipoSolicitud)
                    ,"IdTipoServicio",LookUp(colSolicitudCabTraza,ID=IdSolicitud,IdTipoServicio)
                    ,"TipoServicio",LookUp(colSolicitudCabTraza,ID=IdSolicitud,TipoServicio)
                    ,"AccionOrigen",LookUp(Accion,ID=IdAccionOrigen,Nombre)
                    ,"EtapaOrigen",LookUp(Etapa,ID=IdEtapaOrigen,Nombre)
                    ,"AreaOrigen",LookUp(Area_1,ID=IdAreaOrigen,Nombre)
                    ,"AreaAbrevOrigen",LookUp(Area_1,ID=IdAreaOrigen,NombreAbrev)
                    ,"PerfilOrigen",LookUp(Perfil,ID=IdPerfilOrigen,Nombre)
                    ,"PersonalOrigen",LookUp(Personal,ID=IdPersonalOrigen,Nombre)
                    ,"AccionActual",LookUp(Accion,ID=IdAccionActual,Nombre)
                    ,"EtapaActual",LookUp(Etapa,ID=IdEtapaActual,Nombre)
                    ,"AreaActual",LookUp(Area_1,ID=IdAreaActual,Nombre)
                    ,"AreaAbrevActual",LookUp(Area_1,ID=IdAreaOrigen,NombreAbrev)
                    ,"PerfilActual",LookUp(Perfil,ID=IdPerfilActual,Nombre)
                    ,"PersonalActual",LookUp(Personal,ID=IdPersonalActual,Nombre)
                    ,"AccionDestino",LookUp(Accion,ID=IdAccionDestino,Nombre)
                    ,"EtapaDestino",LookUp(Etapa,ID=IdEtapaDestino,Nombre)
                    ,"AreaDestino",LookUp(Area_1,ID=IdAreaDestino,Nombre)
                    ,"AreaAbrevDestino",LookUp(Area_1,ID=IdAreaDestino,NombreAbrev)
                    ,"PerfilDestino",LookUp(Perfil,ID=IdPerfilDestino,Nombre)
                    ,"PersonalDestino",LookUp(Personal,ID=IdPersonalDestino,Nombre)
                    ,"ManagerDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=2),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    ,"LiderDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=3),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    ,"AnalistaDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=4),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    )
                );
            
            /*
            //Coleccion para obtener el listado solicitudes y detalle de solicitud pendiente de atender del personal que se logueo
            ClearCollect(colSolicitudDetalleDestino;
                Filter(SolicitudDetalleDestino;IdAreaDestino=varMyUser.IdArea;IdPerfilDestino=varMyUser.IdPerfil;IdPersonalDestino=varMyUser.ID));;
            */
        Width: =50
        X: =1261
        Y: =125
        ZIndex: =15

    lblHeader_11 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="PERSONAL ORIGEN"
        Width: =180
        X: =294
        Y: =lblHeader_1.Y
        ZIndex: =16

    lblHeader_12 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="FEC. ATENC."
        Width: =70
        X: =lblHeader_10.X + lblHeader_10.Width
        Y: =lblHeader_1.Y
        ZIndex: =17

    lblHeader_13 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(221, 79, 14, 1)
        FontWeight: =FontWeight.Bold
        Size: =10
        Text: ="ADJ      "
        Width: =60
        X: |
            =lblHeader_12.X + lblHeader_12.Width
        Y: =lblHeader_1.Y
        ZIndex: =18

