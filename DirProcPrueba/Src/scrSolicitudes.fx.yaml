scrSolicitudes As screen:
    OnVisible: |-
        =Select(btnLimpiarS);
        Select(icnActualizarS)

    cmpBarraSuperior_6 As cmpBarraSuperior:

    Rectangle4_6 As rectangle:
        BorderColor: =varColorPri01
        BorderThickness: =1
        Fill: =RGBA(255, 255, 255, 1)
        Height: =699
        OnSelect: =Reset(txtFilNomNroSol_1)
        Width: =1366
        Y: =69
        ZIndex: =2

    lbl_TituloPrincipal_3 As label:
        Align: =Align.Center
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =36
        Size: =24
        Text: ="SOLICITUDES"
        Width: =496
        X: =451
        Y: =17
        ZIndex: =3

    Label3_1 As label:
        Font: =Font.'Segoe UI'
        Height: =33
        Text: ="Nombre / Nro. Solicitud"
        Width: =196
        X: =186
        Y: =80
        ZIndex: =4

    txtFilNomNroSol_1 As text:
        BorderColor: |-
            =//RGBA(0; 18; 107; 1)
            varColorPri01B
        Default: =
        HoverBorderColor: |-
            =//RGBA(0; 18; 107; 1)
            varColorPri01B
        HoverColor: |-
            =RGBA(0, 0, 0, 1)
            //varColorPri01B
        HoverFill: |-
            =//RGBA(186; 202; 226; 1)
            varColorPri01B
        Width: =812
        X: =186
        Y: =113
        ZIndex: =5

    "Gallery1_1 As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
        BorderColor: |-
            =//RGBA(0; 18; 107; 1)
            varColorPri02
        BorderThickness: =1
        Height: =541
        Items: |
            =/*
            Search(
                Filter(colSolicitudes;
                    EsAtendido = false;
                    EsEliminado = false;
                    EsFinalizado = false;
                    EsActivo = true // Va a cambiar cuando se anula la solicitud
                );
                txtFilNomNroSol_1.Text;
                "NroSolicitud";
                "AsuntoSol"
            )
            */
            
            Search(colSolicitudes,
                txtFilNomNroSol_1.Text,
                "NroSolicitud",
                "AsuntoSol"
            )
        Layout: =Layout.Vertical
        OnSelect: |
            =//ClearCollect(colSolicitudDetalleItemSel;Gallery1_1.Selected);;
            //ClearCollect(colSolicitudDetalleItemSelDatosAdj;Gallery1_1.Selected.'Datos adjuntos');;
            Set(varSolicitudDetalleItemSel,LookUp(colSolicitudes,ID=Gallery1_1.Selected.ID));
            Navigate(srcSolicitudDetalle, ScreenTransition.None, { varMisSolicitudesScreen: false });
        TemplateFill: |-
            =//RGBA(0; 0; 0; 0)
            If(ThisItem.IsSelected,varColorPri03B,RGBA(224, 224, 224, 0))
        TemplatePadding: =0
        TemplateSize: =27
        Visible: =!isLoading
        Width: =1175
        X: =181
        Y: =215
        ZIndex: =8

        Title2_7 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.NroSolicitud
            VerticalAlign: =VerticalAlign.Top
            Width: =85
            X: =5
            Y: =4
            ZIndex: =4

        Title2_16 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AsuntoSol
            Tooltip: =ThisItem.AsuntoSol
            VerticalAlign: =VerticalAlign.Top
            Width: =170
            Wrap: =false
            X: =86
            Y: =4
            ZIndex: =5

        Title2_17 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.TipoSolicitud
            VerticalAlign: =VerticalAlign.Top
            Width: =140
            Wrap: =false
            X: =257
            Y: =4
            ZIndex: =6

        Title2_22 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =Text(ThisItem.FechaAtencion,"dd/mm/yy")
            VerticalAlign: =VerticalAlign.Top
            Width: =70
            X: =1008
            Y: =4
            ZIndex: =8

        Title2_23 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =Text(ThisItem.FechaExpiraSLA,"dd/mm/yy")
            VerticalAlign: =VerticalAlign.Top
            Width: =70
            X: =1077
            Y: =4
            ZIndex: =9

        Title2_19 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AreaOrigen
            Tooltip: ="ThisItem.AreaOrigen"
            VerticalAlign: =VerticalAlign.Top
            Width: =100
            Wrap: =false
            X: =487
            Y: =4
            ZIndex: =10

        Title2_20 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AreaDestino
            VerticalAlign: =VerticalAlign.Top
            Width: =100
            X: =587
            Y: =4
            ZIndex: =11

        Icon5_1 As icon.ChevronRight:
            Height: =24
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            Width: =15
            X: =1145
            Y: =2
            ZIndex: =12

        Title2_18 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.TipoServicio
            Tooltip: ="ThisItem.TipoServicio"
            VerticalAlign: =VerticalAlign.Top
            Width: =90
            Wrap: =false
            X: =397
            Y: =4
            ZIndex: =13

        Title2_21 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.ManagerDelArea
            Tooltip: =ThisItem.ManagerDelArea
            VerticalAlign: =VerticalAlign.Top
            Width: =100
            Wrap: =false
            X: =693
            Y: =4
            ZIndex: =14

        Title2_36 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.LiderDelArea
            Tooltip: =ThisItem.LiderDelArea
            VerticalAlign: =VerticalAlign.Top
            Width: =100
            Wrap: =false
            X: =800
            Y: =4
            ZIndex: =15

        Title2_37 As label:
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Normal
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.AnalistaDelArea
            Tooltip: =ThisItem.AnalistaDelArea
            VerticalAlign: =VerticalAlign.Top
            Width: =100
            Wrap: =false
            X: =905
            Y: =4
            ZIndex: =16

    gaMenuLateral_S As gallery.galleryVertical:
        Height: =271
        Items: =colBarraLateral
        Layout: =Layout.Vertical
        TemplateSize: =61
        Transition: =Transition.Pop
        Width: =181
        Y: =69
        ZIndex: =22

        Button2_6 As button:
            Align: =Align.Left
            Fill: =If(ThisItem.texto_boton=varOpcionMenu,varColorPri02,varColorPri02B)
            Font: =Font.'Segoe UI'
            Height: =61
            HoverFill: =ColorFade(varColorPri02, -20%)
            OnSelect: |-
                =Set(varIdOpcionMenu,ThisItem.id_boton);
                Set(varOpcionMenu,ThisItem.texto_boton);
                Navigate(ThisItem.navegacion,ScreenTransition.Cover)
            PaddingLeft: |
                =ThisItem.sangria*10
            Text: =ThisItem.texto_boton
            Width: =171
            ZIndex: =1

    btnExportarS As button:
        Fill: =varColorPri01
        Font: =Font.'Segoe UI'
        HoverFill: =ColorFade(Self.Fill, -10%)
        OnSelect: |-
            =UpdateContext({ isLoading: true });
            
            Exportacion_Excel.Run(
                JSON(
                    ShowColumns(
                        Search(colSolicitudes,
                            txtFilNomNroSol_1.Text,
                            "NroSolicitud",
                            "AsuntoSol"
                        ),
                        "ID", "NroSolicitud", "AsuntoSol", "TipoSolicitud", "TipoServicio", "TipoOperacion", "EsActivo", "RucCliente", "RazonSocialCliente", "AreaOrigen", 
                        "AreaActual", "AreaDestino", "ManagerDelArea", "LiderDelArea", "AnalistaDelArea", "FechaAtencion", 
                        "FechaExpiraSLA", "FechaExpiraOLA", "InicioOperacion", "FinOperacion", "DescripcionPrueba", "ObsSolDet", "FechaCreacionSol"
                    )
                )
            );
            
            UpdateContext({ isLoading: false });
            Notify("Exportacion realizada correctamente.", NotificationType.Success);
        Text: ="Exportar"
        Tooltip: ="Exportar Listado a Excel"
        Width: =100
        X: =1123
        Y: =113
        ZIndex: =23

    btnLimpiarS As button:
        Fill: =varColorPri01
        Font: =Font.'Segoe UI'
        HoverFill: =ColorFade(Self.Fill, -10%)
        OnSelect: =Reset(txtFilNomNroSol)
        Text: ="Limpiar"
        Width: =100
        X: =1013
        Y: =113
        ZIndex: =24

    Group2_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =24

        Rectangle3_1 As rectangle:
            Fill: =varColorPri02
            Height: =50
            Width: =1175
            X: =181
            Y: =163
            ZIndex: =10

        lblHeaderMS_12 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="NRO TICKET"
            Width: =80
            X: =190
            Y: =167
            ZIndex: =11

        lblHeaderMS_13 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="ASUNTO SOL."
            Width: =110
            X: =324
            Y: =167
            ZIndex: =12

        lblHeaderMS_14 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="TIPO SOLIC."
            Width: =80
            X: =477
            Y: =167
            ZIndex: =13

        lblHeaderMS_15 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="TIPO SERV."
            Width: =80
            X: =598
            Y: =167
            ZIndex: =14

        lblHeaderMS_16 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="DPTO. PROCEDENCIA"
            Width: =110
            X: =682
            Y: =167
            ZIndex: =15

        lblHeaderMS_17 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="DPTO. ASIGNADO"
            Width: =100
            X: =795
            Y: =167
            ZIndex: =16

        lblHeaderMS_18 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="MANAGER"
            Width: =93
            X: =897
            Y: =167
            ZIndex: =17

        lblHeaderMS_19 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="LIDER"
            Width: =73
            X: =1013
            Y: =167
            ZIndex: =18

        lblHeaderMS_20 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="ANALISTA"
            Width: =80
            X: =1110
            Y: =167
            ZIndex: =19

        lblHeaderMS_21 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="FECHA CREAC."
            Width: =70
            X: =1191
            Y: =167
            ZIndex: =20

        lblHeaderMS_22 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =varColorPri02
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Size: =10
            Text: ="FECHA EXPIRA"
            Width: =70
            X: =1260
            Y: =167
            ZIndex: =21

    icnActualizarS As icon.Reload:
        BorderColor: |-
            =//RGBA(0; 18; 107; 1)
            varColorPri01B
        Color: =RGBA(236, 64, 38, 1)
        Height: =39
        Icon: =Icon.Reload
        OnSelect: |-
            =UpdateContext({ isLoading: true });
            //ClearCollect(colSolicitudUltDet;AddColumns(Solicitud;"MaxId";Max(Cities;Population)));;
            ClearCollect(colSolicitudUltDet,
            AddColumns(
                       GroupBy(SolicitudDetalle,"IdSolicitud","GroupIdSol"),
                       "MaxID",Max(GroupIdSol,ID)
                       ));
            ClearCollect(colSolicitudCab,
                AddColumns(
                    ShowColumns(Solicitud,"ID","NroSolicitud","AsuntoSol","Obs","EsActivo","EsEliminado","EsFinalizado","IdTipoSolicitud","IdTipoServicio"
                        ,"FechaCreacionSol","FechaFinalSol","RucCliente","RazonSocialCliente","IdTipoOperacion","InicioOperacion","FinOperacion","DescripcionPrueba")
                    ,"TipoSolicitud",LookUp(TipoSolicitud,ID=IdTipoSolicitud,Nombre)
                    ,"TipoServicio",LookUp(TipoServicio,ID=IdTipoServicio,Nombre)
                    ,"TipoOperacion",LookUp(TipoOperacion,ID=IdTipoOperacion,Nombre)
                )
                );
            ClearCollect(colSolicitudes,
                AddColumns(
                    //ShowColumns(SolicitudDetalle;"ID";"FechaAtencion";"FechaExpiraSLA";"FechaExpiraOLA";"EsAtendido";"IdSolicitud";"IdAccionOrigen";"IdEtapaOrigen";"IdAreaOrigen";"IdPerfilOrigen";"IdPersonalOrigen";"IdAccionActual";"IdEtapaActual";"IdAreaActual";"IdPerfilActual";"IdPersonalActual";"IdAccionDestino";"IdEtapaDestino";"IdAreaDestino";"IdPerfilDestino";"IdPersonalDestino")
                    Filter(SolicitudDetalle, ID in colSolicitudUltDet.MaxID)
                    ,"NroSolicitud",LookUp(colSolicitudCab,ID=IdSolicitud,NroSolicitud)
                    ,"AsuntoSol",LookUp(colSolicitudCab,ID=IdSolicitud,AsuntoSol)
                    ,"Obs",LookUp(colSolicitudCab,ID=IdSolicitud,Obs)
                    ,"EsActivo",LookUp(colSolicitudCab,ID=IdSolicitud,EsActivo)
                    ,"EsEliminado",LookUp(colSolicitudCab,ID=IdSolicitud,EsEliminado)
                    ,"EsFinalizado",LookUp(colSolicitudCab,ID=IdSolicitud,EsFinalizado)
                    ,"IdTipoSolicitud",LookUp(colSolicitudCab,ID=IdSolicitud,IdTipoSolicitud)
                    ,"TipoSolicitud",LookUp(colSolicitudCab,ID=IdSolicitud,TipoSolicitud)
                    ,"IdTipoServicio",LookUp(colSolicitudCab,ID=IdSolicitud,IdTipoServicio)
                    ,"TipoServicio",LookUp(colSolicitudCab,ID=IdSolicitud,TipoServicio)
                    ,"FechaCreacionSol",LookUp(colSolicitudCab,ID=IdSolicitud,FechaCreacionSol)
                    ,"FechaFinalSol",LookUp(colSolicitudCab,ID=IdSolicitud,FechaFinalSol)
                    ,"RucCliente",LookUp(colSolicitudCab,ID=IdSolicitud,RucCliente)
                    ,"RazonSocialCliente",LookUp(colSolicitudCab,ID=IdSolicitud,RazonSocialCliente)
                    ,"IdTipoOperacion",LookUp(colSolicitudCab,ID=IdSolicitud,IdTipoOperacion)
                    ,"TipoOperacion",LookUp(colSolicitudCab,ID=IdSolicitud,TipoOperacion)
                    ,"InicioOperacion",LookUp(colSolicitudCab,ID=IdSolicitud,InicioOperacion)
                    ,"FinOperacion",LookUp(colSolicitudCab,ID=IdSolicitud,FinOperacion)
                    ,"DescripcionPrueba",LookUp(colSolicitudCab,ID=IdSolicitud,DescripcionPrueba)
                    ,"AccionOrigen",LookUp(Accion,ID=IdAccionOrigen,Nombre)
                    ,"EtapaOrigen",LookUp(Etapa,ID=IdEtapaOrigen,Nombre)
                    ,"AreaOrigen",LookUp(Area_1,ID=IdAreaOrigen,Nombre)
                    ,"AreaAbrevOrigen",LookUp(Area_1,ID=IdAreaOrigen,NombreAbrev)
                    ,"PerfilOrigen",LookUp(Perfil,ID=IdPerfilOrigen,Nombre)
                    ,"PersonalOrigen",LookUp(Personal,ID=IdPersonalOrigen,Nombre)
                    ,"AccionActual",LookUp(Accion,ID=IdAccionActual,Nombre)
                    ,"EtapaActual",LookUp(Etapa,ID=IdEtapaActual,Nombre)
                    ,"AreaActual",LookUp(Area_1,ID=IdAreaActual,Nombre)
                    ,"AreaAbrevActual",LookUp(Area_1,ID=IdAreaOrigen,NombreAbrev)
                    ,"PerfilActual",LookUp(Perfil,ID=IdPerfilActual,Nombre)
                    ,"PersonalActual",LookUp(Personal,ID=IdPersonalActual,Nombre)
                    ,"AccionDestino",LookUp(Accion,ID=IdAccionDestino,Nombre)
                    ,"EtapaDestino",LookUp(Etapa,ID=IdEtapaDestino,Nombre)
                    ,"AreaDestino",LookUp(Area_1,ID=IdAreaDestino,Nombre)
                    ,"AreaAbrevDestino",LookUp(Area_1,ID=IdAreaDestino,NombreAbrev)
                    ,"PerfilDestino",LookUp(Perfil,ID=IdPerfilDestino,Nombre)
                    ,"PersonalDestino",LookUp(Personal,ID=IdPersonalDestino,Nombre)
                    ,"ManagerDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=2),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    ,"LiderDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=3),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    ,"AnalistaDelArea",Concat(Filter(RenameColumns(SolicitudDetalleDestino,"IdSolicitud","IdSolicitudDetDes","ID","IDSolDetDest"),IdSolicitudDetDes=IdSolicitud,IdSolicitudDetalle=ID,IdPerfilDestino=4),LookUp(Personal,ID=IdPersonalDestino).Nombre & ", ")
                    )
                );
            UpdateContext({ isLoading: false });
        Tooltip: ="Actualizar Listado de Solictudes"
        Width: =50
        X: =1306
        Y: =113
        ZIndex: =25

    Icon7_1 As icon.Folder:
        Color: =varColorPri01
        Height: =40
        Icon: =Icon.Folder
        OnSelect: |-
            =Launch("https://unilabsgroup.sharepoint.com/sites/ProcesodePruebas/Shared%20Documents/Forms/AllItems.aspx?newTargetListUrl=%2Fsites%2FProcesodePruebas%2FShared%20Documents&viewpath=%2Fsites%2FProcesodePruebas%2FShared%20Documents%2FForms%2FAllItems%2Easpx&id=%2Fsites%2FProcesodePruebas%2FShared%20Documents%2FReportes%5FExcel&viewid=052b6700%2D93eb%2D45c7%2Daeaa%2Dc1e1b6dd2521")
        Tooltip: ="Ver Carpeta de Archivos Exportados"
        Width: =40
        X: =btnExportarS.X + btnExportarS.Width + 20
        Y: =btnExportarS.Y + (btnExportarS.Height / 2) - (Self.Height / 2)
        ZIndex: =26

    Rectangle2_13 As rectangle:
        Fill: =RGBA(0, 0, 0, 0.4)
        Height: =Parent.Height
        Visible: =isLoading
        Width: =Parent.Width
        ZIndex: =27

